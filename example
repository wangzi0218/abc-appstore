import React, { useState, useEffect } from 'react';
import { 
  ShoppingBag, CreditCard, Search, Star, Zap, Package, Headphones, 
  AlertCircle, CheckCircle2, X, Plus, Layout, ShieldCheck, TrendingUp, 
  Image as ImageIcon, Crown, Wallet, ArrowRight, ChevronRight, Users, Database, 
  Layers, FileText, Receipt, Settings, User, Clock, Calendar, Info, 
  QrCode, Smartphone, Building2, Upload, ArrowUpCircle, LogOut, Gem, 
  Globe, Monitor, Printer, Activity, MessageCircle, FileSpreadsheet, 
  Store, MapPin, Gift, HeartHandshake, Smile, Network, Warehouse, 
  Pill, FileCheck, PhoneCall, MoreHorizontal, BookOpen, Wifi, Power, 
  RefreshCw, Baby, Stethoscope, HeartPulse, Trophy, MessageSquare
} from 'lucide-react';

// ==========================================
// Constants & Mock Data (Ported from his-store.html)
// ==========================================

const USER_PROFILE = {
    name: "ä¸­å¿ƒåŒ»é™¢ - é—¨è¯Šéƒ¨",
    currentVersion: "åŸºç¡€ç‰ˆ", 
    balance: 2450.00,
    points: 1200
};

const VERSION_LEVELS: Record<string, number> = { "åŸºç¡€ç‰ˆ": 1, "ä¸“ä¸šç‰ˆ": 2, "æ——èˆ°ç‰ˆ": 3, "å¤§å®¢æˆ·ç‰ˆ": 4 };

const INITIAL_INVOICE_INFO = {
    type: 'company',
    title: 'ä¸­å¿ƒåŒ»é™¢æœ‰é™å…¬å¸',
    taxId: '91330100MA2G123456',
    address: 'æ­å·å¸‚è¥¿æ¹–åŒºæ–‡ä¸€è¥¿è·¯ 99 å·',
    phone: '0571-88888888'
};

const MOCK_REVIEWS = [
    { id: 'r1', user: 'åˆ˜åŒ»ç”Ÿ', role: 'å…¨ç§‘åŒ»å¸ˆ', avatarColor: 'bg-blue-500', rating: 5, date: '2023-10-15', content: 'å¾®è¯Šæ‰€çœŸçš„å¥½ç”¨ï¼Œå¾ˆå¤šå¹´è½»æ‚£è€…ç›´æ¥å¾®ä¿¡é¢„çº¦è¿‡æ¥ï¼Œä¸ç”¨åœ¨å‰å°æ’é˜Ÿï¼Œå¤§å®¶éƒ½çœäº‹ã€‚', tags: ['å¼•æµç¥å™¨', 'ä½“éªŒå¥½'] },
    { id: 'r2', user: 'é™ˆæŠ¤å£«', role: 'å‰å°ä¸»ç®¡', avatarColor: 'bg-green-500', rating: 5, date: '2023-09-20', content: 'ä»¥å‰å«å·å…¨é å–Šï¼Œå—“å­éƒ½å“‘äº†ã€‚ç°åœ¨ç”µè§†æœºä¸€æŒ‚ï¼Œæ‚£è€…è‡ªå·±çœ‹å±å¹•ï¼Œå¤§å…å®‰é™å¤šäº†ã€‚', tags: ['ç¯å¢ƒæ”¹å–„', 'ç§©åºäº•ç„¶'] },
    { id: 'r3', user: 'èµµé™¢é•¿', role: 'è´Ÿè´£äºº', avatarColor: 'bg-purple-500', rating: 4, date: '2023-08-10', content: 'äº‘æ£€ä»ªå™¨å›æŠ¥ç‡å¾ˆé«˜ï¼Œä»¥å‰åšä¸äº†çš„è¡€å¸¸è§„ç°åœ¨8åˆ†é’Ÿå‡ºç»“æœï¼Œæ‚£è€…ä¹Ÿæ„¿æ„åœ¨è¯Šæ‰€åšæ£€æŸ¥äº†ã€‚', tags: ['å¢æ”¶', 'æ–¹ä¾¿'] },
    { id: 'r4', user: 'è´¢åŠ¡æå§', role: 'è´¢åŠ¡', avatarColor: 'bg-orange-500', rating: 5, date: '2023-11-01', content: 'èšåˆæ”¯ä»˜ç›’å­å¤ªçœå¿ƒäº†ï¼Œæ™šä¸Šè‡ªåŠ¨å¯¹è´¦ï¼Œå†ä¹Ÿä¸ç”¨ä¸€ä¸ªä¸ªæ ¸å¯¹å¾®ä¿¡æ”¯ä»˜å®æµæ°´äº†ã€‚', tags: ['çœå¿ƒ', 'é«˜æ•ˆ'] }
];

const INITIAL_TRANSACTIONS = [
    { 
        id: 't1', orderNo: 'ORD202310240001', date: '2023-10-24 14:20', item: 'è´¦æˆ·ä½™é¢å……å€¼', type: 'recharge', 
        amount: 2000.00, originalPrice: 2000.00, discount: 0, status: 'success', deliveryStatus: 'delivered', 
        invoiced: false, paymentMethod: 'å¾®ä¿¡æ”¯ä»˜', snapshot: { period: 'æ°¸ä¹…æœ‰æ•ˆ' }
    }
];

const PRODUCTS = [
    // --- 1. æ ¸å¿ƒåº”ç”¨ ---
    {
        id: "weclinic", title: "å¾®è¯Šæ‰€ (å¾®ä¿¡è¥é”€ç‰ˆ)", description: "æŠŠæŒ‚å·çª—å£æ¬è¿›æ‚£è€…æ‰‹æœºï¼Œåƒç‚¹å¤–å–ä¸€æ ·çœ‹ç—…ï¼Œ24å°æ—¶æ¥å•ä¸æ‰“çƒŠã€‚",
        price: 1680, type: "software", rating: 4.9, reviewsCount: 328, minVersionRequired: "ä¸“ä¸šç‰ˆ", 
        isOwned: true, purchaseInfo: { expiryDate: '2025-12-31', status: 'active', usage: 'ç´¯è®¡æœåŠ¡ 1.2w äººæ¬¡', authorizedStores: ['ä¸­å¿ƒåŒ»é™¢ - é—¨è¯Šéƒ¨'] },
        tags: ["è·å®¢ç¥å™¨", "å¾®ä¿¡ç”Ÿæ€"], imageColor: "bg-green-100", scope: "all_stores", 
        markdownContent: `## ä¸ºä»€ä¹ˆä½ éœ€è¦å¾®è¯Šæ‰€ï¼Ÿ\n**åˆ«è®©æ‚£è€…å› ä¸ºâ€œéº»çƒ¦â€è€Œæµå¤±ã€‚**\n\næƒ³è±¡ä¸€ä¸‹ï¼Œæ·±å¤œå­©å­å‘çƒ§çš„å®¶é•¿ï¼Œæˆ–è€…å¿™ç¢Œçš„ä¸Šç­æ—ï¼Œä»–ä»¬æœ€éœ€è¦çš„æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯**ç¡®å®šæ€§**ã€‚å¾®è¯Šæ‰€è®©æ‚£è€…åœ¨å®¶é‡Œå°±èƒ½çœ‹åˆ°åŒ»ç”Ÿçš„æ’ç­ï¼Œé”å®šå°±è¯Šæ—¶é—´ã€‚\n\n![å¾®è¯Šæ‰€ç•Œé¢æ¼”ç¤º](placeholder-weclinic-ui)\n\n## å®ƒèƒ½æ”¹å˜ä»€ä¹ˆï¼Ÿ\n- **å‰å°ä¸å¿™ä¹±äº†**ï¼šå¤§éƒ¨åˆ†æ‚£è€…å·²ç»åœ¨çº¿ä¸Šå¡«å¥½äº†ä¿¡æ¯ï¼ŒæŒ‚å¥½äº†å·ï¼Œåˆ°åº—ç›´æ¥å°±è¯Šã€‚\n- **æ‚£è€…ä¸çˆ½çº¦äº†**ï¼šå¾®ä¿¡è‡ªåŠ¨æ¨é€â€œæ˜å¤©ä¸Šåˆ10ç‚¹å°±è¯Šâ€çš„æé†’ï¼Œçˆ½çº¦ç‡ç›´çº¿ä¸‹é™ã€‚\n- **çœ‹èµ·æ¥æ›´ä¸“ä¸š**ï¼šç²¾ç¾çš„å¾®å®˜ç½‘ï¼Œå±•ç¤ºä¸“å®¶é£é‡‡å’Œè¯Šæ‰€ç¯å¢ƒï¼Œç¬é—´æ‹‰å¼€ä¸éš”å£è€æ—§è¯Šæ‰€çš„å·®è·ã€‚`,
        features: ["å¾®ä¿¡å…¬ä¼—å·æ— ç¼åµŒå…¥", "å…¨æµç¨‹è‡ªåŠ©æŒ‚å·/ç¼´è´¹", "æ£€æŸ¥æŠ¥å‘Šè‡ªåŠ¨æ¨é€åˆ°æ‰‹æœº", "åŒ»ç”Ÿæ’ç­å®æ—¶å±•ç¤º"], benefits: ["æå‡æ‚£è€…ä½“éªŒ", "é™ä½çˆ½çº¦ç‡", "å‡è½»å‰å°å·¥ä½œé‡"], 
        reviews: [MOCK_REVIEWS[0]], trialDays: 7, guarantee: "ä¸“äººååŠ©é…ç½®",
        guideSteps: [{ title: "ç»‘å®šå…¬ä¼—å·", desc: "åœ¨ã€ç³»ç»Ÿè®¾ç½®-å¾®è¯Šæ‰€ã€‘ä¸­æˆæƒæ‚¨çš„å¾®ä¿¡æœåŠ¡å·ã€‚" }, { title: "é…ç½®æ’ç­", desc: "åŒæ­¥åŒ»ç”Ÿæ’ç­ä¿¡æ¯ã€‚" }, { title: "å‘å¸ƒæ¨å¹¿", desc: "ä¸‹è½½è¯Šæ‰€ä¸“å±äºŒç»´ç ï¼Œè´´åœ¨å‰å°æ˜¾çœ¼å¤„ã€‚" }]
    },
    {
        id: "lis_pacs", title: "æ£€éªŒæ£€æŸ¥ LIS/PACS ç³»ç»Ÿ", description: "è®©æ£€éªŒè®¾å¤‡â€œå¼€å£è¯´è¯â€ï¼Œæ•°æ®è‡ªåŠ¨ä¸Šä¼ ï¼Œå‘Šåˆ«æ‰‹å·¥å½•å…¥çš„ç¹çä¸é”™è¯¯ã€‚",
        price: 3980, type: "software", rating: 4.8, reviewsCount: 156, minVersionRequired: "æ——èˆ°ç‰ˆ", 
        isOwned: false, tags: ["æ•ˆç‡å·¥å…·", "æ•°æ®äº’é€š"], imageColor: "bg-blue-100", scope: "per_store", 
        markdownContent: `## è¿˜åœ¨æ‰‹å·¥æŠ„å†™æ£€éªŒç»“æœå—ï¼Ÿ\n\næ‰‹å·¥å½•å…¥ä¸ä»…æ…¢ï¼Œæœ€æ€•çš„æ˜¯**æŠŠâ€œ3.5â€å½•æˆâ€œ5.3â€**ã€‚ä¸€æ—¦å‡ºé”™ï¼ŒåŒ»ç–—é£é™©å·¨å¤§ã€‚LIS ç³»ç»Ÿå°±æ˜¯æ‚¨æ£€éªŒç§‘çš„â€œç¿»è¯‘å®˜â€ï¼ŒæŠŠè®¾å¤‡çš„æ•°æ®ç›´æ¥ç¿»è¯‘åˆ°åŒ»ç”Ÿçš„ç”µè„‘å±å¹•ä¸Šã€‚\n\n![LISç³»ç»Ÿå·¥ä½œå°](placeholder-lis-workstation)\n\n## æ ¸å¿ƒä»·å€¼\n- **é›¶å·®é”™**ï¼šæœºå™¨å¯¹æ¥æœºå™¨ï¼Œæœç»äººä¸ºæ‰‹è¯¯ã€‚\n- **ç§’çº§ä¼ è¾“**ï¼šä»ªå™¨åˆšå‡ºç»“æœï¼ŒåŒ»ç”Ÿç”µè„‘ä¸Šé©¬ä¸Šå¼¹çª—æé†’ã€‚\n- **ä¸‰ç”²çº§æŠ¥å‘Š**ï¼šå†…ç½® 5000+ ä»½æ ‡å‡†æŠ¥å‘Šæ¨¡æ¿ï¼Œæ‰“å°å‡ºæ¥ä¸“ä¸šåˆæ¼‚äº®ï¼Œæ‚£è€…çœ‹ç€å°±æ”¾å¿ƒã€‚`,
        features: ["æ”¯æŒ95%ä¸»æµæ£€éªŒè®¾å¤‡", "å›¾æ–‡æŠ¥å‘Šä¸€é”®æ‰“å°", "DICOM å½±åƒåœ¨çº¿æµè§ˆ", "å±æœºå€¼è‡ªåŠ¨é¢„è­¦"], benefits: ["æœç»å½•å…¥é”™è¯¯", "æå‡è¯Šæ‰€ä¸“ä¸šå½¢è±¡", "ç¼©çŸ­æ‚£è€…ç­‰å¾…æ—¶é—´"], reviews: [], trialDays: 15
    },
    {
        id: "queuing", title: "æ™ºèƒ½æ’é˜Ÿå«å·ç³»ç»Ÿ", description: "å‘Šåˆ«â€œé€šè®¯åŸºæœ¬é å¼â€ï¼Œå¤§å…ç¬é—´å®‰é™æœ‰åºï¼Œæå‡å°±è¯Šä½“éªŒçš„æ€§ä»·æ¯”ä¹‹é€‰ã€‚",
        price: 980, type: "software", rating: 4.7, reviewsCount: 210, minVersionRequired: "ä¸“ä¸šç‰ˆ", 
        isOwned: true, purchaseInfo: { expiryDate: '2024-11-20', status: 'expiring', authorizedStores: ['ä¸­å¿ƒåŒ»é™¢ - é—¨è¯Šéƒ¨'], usage: '1 å°è®¾å¤‡åœ¨çº¿' },
        tags: ["ç§©åºç®¡ç†", "æå‡å½¢è±¡"], imageColor: "bg-purple-100", scope: "per_store", 
        markdownContent: `## è®©è¯Šæ‰€å¤§å…åƒé“¶è¡Œä¸€æ ·å®‰é™\n\nå˜ˆæ‚çš„å°±è¯Šç¯å¢ƒä¼šè®©æ‚£è€…çƒ¦èºï¼Œä¹Ÿä¼šå½±å“åŒ»ç”Ÿé—®è¯Šã€‚ä½ åªéœ€è¦**ä¸€å°æ™®é€šç”µè§† + æˆ‘ä»¬çš„ç›’å­**ï¼Œç«‹é©¬å‡çº§ä¸ºæ™ºèƒ½å«å·å¤§å±ã€‚\n\n![å«å·å¤§å±æ•ˆæœ](placeholder-queuing-screen)\n\n## è§£å†³ä¸‰å¤§ç—›ç‚¹\n- **å‘Šåˆ«æ‹¥æŒ¤**ï¼šæ‚£è€…çœ‹ç€å±å¹•ç­‰ï¼Œä¸ç”¨å›´åœ¨è¯Šå®¤é—¨å£æ¢å¤´æ¢è„‘ã€‚\n- **ä¿æŠ¤éšç§**ï¼šä¸¥æ ¼æ‰§è¡Œâ€œä¸€åŒ»ä¸€æ‚£â€ï¼Œå«åˆ°åå­—å†è¿›å»ï¼Œæ‚£è€…æ›´æ•¢äºæ²Ÿé€šç—…æƒ…ã€‚\n- **å‡å°‘çº çº·**ï¼šç³»ç»Ÿè‡ªåŠ¨æ’åºï¼Œè°å…ˆæ¥è°ååˆ°ï¼Œæœç»æ’é˜Ÿäº‰åµã€‚`,
        features: ["ç”µè§†æŠ•å±æ˜¾ç¤ºæ’é˜Ÿä¿¡æ¯", "è¯­éŸ³è‡ªåŠ¨æ’­æŠ¥å§“å", "è¿‡å·è‡ªåŠ¨é¡ºå»¶é€»è¾‘", "æ€¥è¯Šä¸€é”®ä¼˜å…ˆæ’é˜Ÿ"], benefits: ["ç»´æŠ¤å°±è¯Šç§©åº", "ä¿æŠ¤æ‚£è€…éšç§", "é™ä½åŒ»æ‚£çº çº·"], reviews: [MOCK_REVIEWS[1]], guarantee: "èµ é€ç”µè§†ç›’å­è½¯ä»¶",
        guideSteps: [{ title: "å®‰è£…ç›’å­", desc: "å°†èµ é€çš„ç›’å­è¿æ¥åˆ°ç”µè§†HDMIæ¥å£ã€‚" }, { title: "è”ç½‘é…å¯¹", desc: "è¾“å…¥å±å¹•ä¸Šçš„é…å¯¹ç ç»‘å®šè¯Šæ‰€ã€‚" }, { title: "å¼€å¯å«å·", desc: "åŒ»ç”Ÿæ¥è¯Šå®Œä¸€ä½ï¼Œç‚¹å‡»â€œä¸‹ä¸€ä½â€å³å¯ã€‚" }]
    },
    {
        id: "payment", title: "ABC èšåˆæ”¯ä»˜ç›’å­", description: "ä¸€ä¸ªç æå®šåŒ»ä¿ã€å¾®ä¿¡ã€æ”¯ä»˜å®ã€‚è‡ªåŠ¨è¯­éŸ³æ’­æŠ¥ï¼Œè´¢åŠ¡æ™šä¸Šä¸å†æ„å¯¹è´¦ã€‚",
        price: 299, type: "hardware", rating: 5.0, reviewsCount: 890, minVersionRequired: "åŸºç¡€ç‰ˆ", 
        isOwned: true, purchaseInfo: { expiryDate: 'æ°¸ä¹…æœ‰æ•ˆ', status: 'active', authorizedStores: ['ä¸­å¿ƒåŒ»é™¢ - é—¨è¯Šéƒ¨', 'åŸè¥¿åˆ†é™¢'], usage: '2 å°è®¾å¤‡' },
        tags: ["æé€Ÿæ”¶æ¬¾", "è‡ªåŠ¨å¯¹è´¦"], imageColor: "bg-orange-100", scope: "per_store", 
        markdownContent: `## æ”¶æ¬¾è¿™ä»¶å°äº‹ï¼Œåƒä¸‡åˆ«é©¬è™\n\nå¾ˆå¤šè¯Šæ‰€è¿˜åœ¨ç”¨ä¸ªäººçš„å¾®ä¿¡æ”¶æ¬¾ç ï¼Œä¸ä»…è´¹ç‡é«˜ï¼Œè€Œä¸”**è´¦ç›®æ··ä¹±ï¼Œæ— æ³•å¯¹æ¥åŒ»ä¿**ã€‚è¿™æ˜¯ä¸“ä¸ºåŸºå±‚åŒ»ç–—å®šåˆ¶çš„æ”¶é“¶ç¥å™¨ã€‚\n\n![èšåˆæ”¯ä»˜ç›’å­](placeholder-payment-box)\n\n## ä¸ºä»€ä¹ˆé€‰å®ƒï¼Ÿ\n- **å…¨èƒ½æ”¶**ï¼šæ‚£è€…æå‡ºæ‰‹æœºï¼Œä¸ç®¡æ˜¯**åŒ»ä¿ç”µå­å‡­è¯**ã€å¾®ä¿¡è¿˜æ˜¯æ”¯ä»˜å®ï¼Œæ‰«ä¸€ä¸‹å…¨æå®šã€‚\n- **é˜²æ¼å•**ï¼šæ”¶æ¬¾æˆåŠŸåï¼Œå¤§éŸ³é‡æ’­æŠ¥â€œæ”¶æ¬¾ XX å…ƒâ€ï¼Œå¿™ä¹±ä¸­ä¹Ÿä¸ä¼šæ¼æ”¶ã€‚\n- **è‡ªåŠ¨å¯¹è´¦**ï¼šç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆæ—¥æŠ¥è¡¨ï¼Œæ¯ä¸€ç¬”é’±éƒ½æ¸…æ¸…æ¥šæ¥šï¼Œä¸ç”¨å†æ‹¿ç€è®¡ç®—å™¨æŒ‰åŠå¤©ã€‚`,
        features: ["æ”¯æŒåŒ»ä¿ç”µå­å‡­è¯/å¾®ä¿¡/æ”¯ä»˜å®", "0.33% åŒ»ç–—ä¸“å±ä½è´¹ç‡", "T+1 è‡ªåŠ¨ç»“ç®—åˆ°è´¦", "å¤§éŸ³é‡è¯­éŸ³æ’­æŠ¥"], benefits: ["æ¯å¹´èŠ‚çœæ•°åƒå…ƒæ‰‹ç»­è´¹", "è´¢åŠ¡å¯¹è´¦æ•ˆç‡æå‡10å€", "æ”¯æŒåŒ»ä¿è„±å¡æ”¯ä»˜"], reviews: [MOCK_REVIEWS[3]], guarantee: "åæŸå…è´¹æ¢æ–°"
    },
    {
        id: "cloud_exam", title: "äº‘æ£€æ™ºèƒ½åˆ†æä»ª", description: "è¯Šæ‰€é‡Œçš„å¾®å‹æ£€éªŒç§‘ã€‚0æˆæœ¬æŠ•æ”¾ï¼ŒæŠ¤å£«å°±èƒ½æ“ä½œï¼Œç•™ä½æ£€æŸ¥è´¹ï¼Œå¢åŠ æ”¶å…¥ã€‚",
        price: 0, type: "hardware", rating: 4.6, reviewsCount: 65, minVersionRequired: "åŸºç¡€ç‰ˆ", 
        isOwned: false, tags: ["å¢æ”¶åˆ©å™¨", "AIè§£è¯»"], imageColor: "bg-teal-100", scope: "per_store", 
        markdownContent: `## åˆ«å†æŠŠæ‚£è€…å¾€å¤§åŒ»é™¢æ¨äº†\n\næ‚£è€…å‘çƒ§äº†æ˜¯ç»†èŒæ„ŸæŸ“è¿˜æ˜¯ç—…æ¯’æ„ŸæŸ“ï¼Ÿä»¥å‰åªèƒ½å‡­ç»éªŒçŒœï¼Œæˆ–è€…è®©æ‚£è€…å»å¤§åŒ»é™¢æŸ¥è¡€ã€‚ç°åœ¨ï¼Œ**æŠŠæ£€æŸ¥ç•™åœ¨è¯Šæ‰€åšï¼Œæ—¢æ–¹ä¾¿æ‚£è€…ï¼Œåˆèƒ½å¢åŠ æ”¶å…¥ã€‚**\n\n![äº‘æ£€åˆ†æä»ª](placeholder-cloud-exam)\n\n## æ ¸å¿ƒä¼˜åŠ¿\n- **å‚»ç“œå¼æ“ä½œ**ï¼šä¸éœ€è¦ä¸“ä¸šæ£€éªŒå¸ˆï¼ŒæŠ¤å£«åŸ¹è®­ 10 åˆ†é’Ÿå°±èƒ½ä¸Šå²—ã€‚\n- **ç«‹ç­‰å¯å–**ï¼šæŒ‡å°–é‡‡è¡€ï¼Œ**8 åˆ†é’Ÿ**å‡ºç»“æœï¼Œæ‚£è€…æ„¿æ„ç­‰ã€‚\n- **AI è¾…åŠ©**ï¼šæœºå™¨ä¸ä»…å‡ºæ•°æ®ï¼Œè¿˜ç”¨ AI å¸®ä½ è§£è¯»ç»“æœï¼Œè¾…åŠ©è¯Šæ–­ã€‚`,
        features: ["äº”åˆ†ç±»è¡€å¸¸è§„+CRP+SAA", "8åˆ†é’Ÿå¿«é€Ÿæ£€æµ‹", "AIè¾…åŠ©åˆ¤è¯»æŠ¥å‘Š", "å¹²å¼è¯•å‰‚å¸¸æ¸©ä¿å­˜"], benefits: ["ç›´æ¥å¢åŠ æ£€æŸ¥æ”¶å…¥", "è§„èŒƒæŠ—ç”Ÿç´ ä½¿ç”¨", "æå‡è¯Šæ–­å‡†ç¡®ç‡"], reviews: [MOCK_REVIEWS[2]], guarantee: "è®¾å¤‡å…è´¹æŠ•æ”¾ï¼Œåªéœ€æ‰¿è¯ºè€—æé‡"
    },
    // --- 2. è¿è¥å¢é•¿ ---
    {
        id: "micro_mall", title: "å¾®å•†åŸ (è¯å“/ç†ç–—é›¶å”®)", description: "è¯Šæ‰€çš„â€œçº¿ä¸Šæ·˜å®åº—â€ã€‚ä¸ä»…å–è¯ï¼Œè¿˜èƒ½é¢„å”®ä¸‰ä¼è´´ã€æ¨æ‹¿å¡ï¼Œç¡è§‰ä¹Ÿèƒ½èµšé’±ã€‚",
        price: 2980, type: "software", rating: 4.7, reviewsCount: 42, minVersionRequired: "ä¸“ä¸šç‰ˆ",
        isOwned: false, tags: ["ç”µå•†å¢æ”¶", "O2O"], imageColor: "bg-pink-100", scope: "all_stores", 
        markdownContent: `## çªç ´ç‰©ç†ç©ºé—´çš„é™åˆ¶\n\nè¯Šæ‰€åªæœ‰å¼€é—¨æ‰æœ‰ç”Ÿæ„ï¼Ÿå¾®å•†åŸå¸®æ‚¨æŠŠè¯æˆ¿è´§æ¶å»¶ä¼¸åˆ°æ‚£è€…å®¶é‡Œï¼Œå®ç° **24å°æ—¶åˆ›æ”¶**ã€‚\n\n![å¾®å•†åŸç•Œé¢](placeholder-mall)\n\n## æ€ä¹ˆå¸®æ‚¨èµšé’±ï¼Ÿ\n- **çˆ†å“é¢„å”®**ï¼šåˆ°äº†å†¬ç—…å¤æ²»çš„æ—¶å€™ï¼Œæå‰åœ¨å•†åŸé¢„å”®â€œä¸‰ä¼è´´â€ï¼Œå›ç¬¼èµ„é‡‘ï¼Œé”å®šå®¢æºã€‚\n- **ç–—ç¨‹é”å®¢**ï¼šæŠŠå°å„¿æ¨æ‹¿åšæˆâ€œ10æ¬¡å¡â€åœ¨çº¿é”€å”®ï¼Œæ‚£è€…ä¹°äº†å¡ï¼Œè‡ªç„¶å°±ä¼šå¸¸æ¥ã€‚\n- **O2O è´­è¯**ï¼šè€æ…¢ç—…æ‚£è€…è¯åƒå®Œäº†ï¼Ÿæ‰‹æœºä¸‹å•ï¼Œé€‰æ‹©â€œåˆ°åº—è‡ªæâ€æˆ–â€œåŒåŸé…é€â€ï¼Œæ–¹ä¾¿åˆå¿«æ·ã€‚`,
        features: ["å•†å“ä¸Šä¸‹æ¶ä¸åº“å­˜åŒæ­¥", "åŒåŸé…é€/å¿«é€’å¯¹æ¥", "æ‹¼å›¢/ç§’æ€è¥é”€å·¥å…·", "ç–—ç¨‹å¡/æ¬¡å¡è™šæ‹Ÿå•†å“é”€å”®"], benefits: ["å¢åŠ éè¯Šç–—æ”¶å…¥", "æå‰é”å®šå®¢æˆ·èµ„é‡‘", "æå‡è€å®¢å¤è´­ç‡"], reviews: [], trialDays: 7
    },
    {
        id: "adv_marketing", title: "è¶…çº§è¥é”€æ’ä»¶", description: "åƒç”µå•†ä¸€æ ·ç©è½¬åŒ»ç–—è¥é”€ã€‚å‘ä¼˜æƒ åˆ¸ã€æ»¡å‡ã€é™æ—¶æŠ˜æ‰£ï¼Œæ¿€æ´»æ²‰ç¡è€å®¢æˆ·ã€‚",
        price: 1200, type: "software", rating: 4.7, reviewsCount: 112, minVersionRequired: "ä¸“ä¸šç‰ˆ",
        isOwned: false, tags: ["ä¿ƒé”€ç¥å™¨", "æé«˜å®¢å•"], imageColor: "bg-rose-100", scope: "all_stores",
        markdownContent: `## è¯Šæ‰€ç”Ÿæ„å†·æ¸…ï¼Ÿæ¥ç‚¹â€œç‹ â€çš„ä¿ƒé”€æ‰‹æ®µï¼\n\nä¸è¦åç­‰æ‚£è€…ä¸Šé—¨ã€‚**è¶…çº§è¥é”€æ’ä»¶ï¼Œç»™æ‚£è€…ä¸€ä¸ªâ€œå¿…é¡»ç°åœ¨æ¥â€çš„ç†ç”±ã€‚**\n\n![ä¼˜æƒ åˆ¸è®¾ç½®ç•Œé¢](placeholder-marketing)\n\n## ä¸‰å¤§å¸é‡‘ç©æ³•\n- **æ–°äººç¤¼åŒ…**ï¼šæ–°å®¢å…³æ³¨å…¬ä¼—å·ï¼Œè‡ªåŠ¨å‘ä¸€å¼ â€œæ»¡ 100 å‡ 10 å…ƒâ€åˆ¸ï¼Œè½¬åŒ–ç‡ç¿»å€ã€‚\n- **ä¼šå‘˜æ—¥æŠ˜æ‰£**ï¼šè®¾å®šæ¯å‘¨ä¸‰ä¸ºâ€œä¼šå‘˜æ—¥â€ï¼Œç†ç–—é¡¹ç›® 8 æŠ˜ï¼ŒæŠŠé—²æ—¶å˜å¿™æ—¶ã€‚\n- **å®šå‘å”¤é†’**ï¼šç»™ 3 ä¸ªæœˆæ²¡æ¥çš„é«˜è¡€å‹æ‚£è€…å‘ä¸€å¼ â€œå…è´¹æµ‹è¡€å‹åˆ¸â€ï¼ŒæŠŠäººå–Šå›æ¥ï¼Œè‡ªç„¶å°±æœ‰åç»­è½¬åŒ–ã€‚`,
        features: ["ç”µå­ä¼˜æƒ åˆ¸/æŠ˜æ‰£åˆ¸", "æ»¡å‡/æ»¡èµ è§„åˆ™è®¾ç½®", "é™æ—¶ç§’æ€æ´»åŠ¨", "æ–°äººå¤§ç¤¼åŒ…è‡ªåŠ¨å‘"], benefits: ["æé«˜å®¢å•ä»·", "æ¿€æ´»æ²‰ç¡å®¢æˆ·", "å¡«è¡¥ä¸šåŠ¡ä½è°·æœŸ"], reviews: [], trialDays: 7
    },
    {
        id: "scrm", title: "ä¼å¾®ç§åŸŸç®¡å®¶", description: "æŠŠæ‚£è€…è£…è¿›â€œå…¬å¸â€çš„å£è¢‹ã€‚åŒ»ç”Ÿç¦»èŒå¸¦ä¸èµ°å®¢æˆ·ï¼Œåˆè§„ç¾¤å‘ä¸å°å·ï¼Œç²¾ç»†åŒ–è¿è¥ã€‚",
        price: 2500, type: "software", rating: 4.7, reviewsCount: 205, minVersionRequired: "ä¸“ä¸šç‰ˆ",
        isOwned: false, tags: ["å®¢æˆ·èµ„äº§", "ç§åŸŸè¿è¥"], imageColor: "bg-cyan-100", scope: "all_stores", 
        markdownContent: `## è¿˜åœ¨ç”¨åŒ»ç”Ÿä¸ªäººå¾®ä¿¡åŠ æ‚£è€…ï¼Ÿå¤ªå±é™©äº†ï¼\n\nåŒ»ç”Ÿç¦»èŒäº†ï¼Œå¾®ä¿¡ä¸€åˆ ï¼Œå‡ åƒä¸ªæ‚£è€…å…¨å¸¦èµ°äº†ã€‚**ä¼å¾®ç®¡å®¶å¸®æ‚¨æŠŠæ‚£è€…å˜æˆè¯Šæ‰€çš„æ°¸ä¹…èµ„äº§ã€‚**\n\n![ä¼å¾®ä¾§è¾¹æ ](placeholder-scrm)\n\n## ç›¸æ¯”ä¸ªäººå¾®ä¿¡çš„ä¼˜åŠ¿\n- **èµ„äº§å½’å±**ï¼šæ‚£è€…åŠ çš„æ˜¯å¸¦æœ‰â€œè¯Šæ‰€è®¤è¯â€çš„ä¼ä¸šå¾®ä¿¡ï¼Œä¿¡ä»»åº¦æ›´é«˜ï¼Œç¦»èŒå¯ä¸€é”®åˆ†é…ç»™æ–°åŒ»ç”Ÿã€‚\n- **ä¾§è¾¹æ **ï¼šèŠå¤©æ—¶ï¼Œå³ä¾§è‡ªåŠ¨æ˜¾ç¤ºè¯¥æ‚£è€…çš„ç—…å†ã€è¿‡æ•å²ã€ä¸Šæ¬¡å¼€è¯è®°å½•ï¼Œæ²Ÿé€šæ›´ç²¾å‡†ã€‚\n- **åˆè§„ç¾¤å‘**ï¼šä¸€é”®ç»™å‡ åƒäººç¾¤å‘èŠ‚æ—¥ç¥ç¦æˆ–é€šçŸ¥ï¼Œ**ä¸è¢«å°å·**ï¼Œåˆ°è¾¾ç‡æé«˜ã€‚`,
        features: ["ç¦»èŒå®¢æˆ·ä¸€é”®ç»§æ‰¿", "èŠå¤©ä¾§è¾¹æ (çœ‹ç—…å†/å‘è¯æœ¯)", "æ— é™æ¬¡åˆè§„ç¾¤å‘", "ä¼šè¯å†…å®¹å­˜æ¡£å®¡è®¡"], benefits: ["é˜²æ­¢æ ¸å¿ƒå®¢æˆ·æµå¤±", "æå‡å®¢æœå“åº”æ•ˆç‡", "è¥é”€è§¦è¾¾æ›´å®‰å…¨"], reviews: [], trialDays: 7
    },
    {
        id: "meituan_connect", title: "ç¾å›¢ç‚¹è¯„ç›´è¿", description: "æ‰“å¼€å…¬åŸŸæµé‡çš„æ°´é¾™å¤´ã€‚å›¢è´­è®¢å•è‡ªåŠ¨æ ¸é”€ï¼Œæ’ç­å®æ—¶åŒæ­¥ï¼ŒæŠ“ä½å¹´è½»å®¢ç¾¤ã€‚",
        price: 3000, type: "service", rating: 4.8, reviewsCount: 150, minVersionRequired: "åŸºç¡€ç‰ˆ",
        isOwned: false, tags: ["å…¬åŸŸå¼•æµ", "O2O"], imageColor: "bg-yellow-200", scope: "per_store",
        markdownContent: `## è¿˜åœ¨æ„æ²¡æ–°å®¢ï¼Ÿå¹´è½»äººéƒ½æœå¤§ä¼—ç‚¹è¯„\n\nç°åœ¨çš„å¹´è½»äººçœ‹ç‰™ã€çœ‹ä¸­åŒ»ã€åšç†ç–—ï¼Œç¬¬ä¸€ååº”æ˜¯æœç¾å›¢ã€‚**æ‰“é€šç¾å›¢ï¼Œå°±æ˜¯è®©è¯Šæ‰€åœ¨è¿™é‡Œâ€œæ’æ——å åœ°â€ã€‚**\n\n![ç¾å›¢é—¨åº—å±•ç¤º](placeholder-meituan)\n\n## ç›´è¿ä¼˜åŠ¿\n- **è‡ªåŠ¨æ¥å•**ï¼šæ‚£è€…åœ¨ç¾å›¢ä¹°äº†â€œæ´—ç‰™å¥—é¤â€ï¼Œè®¢å•è‡ªåŠ¨åŒæ­¥åˆ° HIS ç³»ç»Ÿï¼Œå‰å°ä¸ç”¨å†æ‰‹æŠ„æ ¸é”€ç ã€‚\n- **æ’ç­åŒæ­¥**ï¼šåŒ»ç”Ÿåœ¨ HIS é‡Œè¯·äº†å‡ï¼Œç¾å›¢ä¸Šçš„é¢„çº¦å·æºè‡ªåŠ¨å…³é—­ï¼Œé¿å…æ’å•å°´å°¬ã€‚\n- **è¯„ä»·ç®¡ç†**ï¼šç›´æ¥åœ¨ç³»ç»Ÿé‡Œå›å¤ç¾å›¢è¯„ä»·ï¼Œæå‡åº—é“ºè¯„åˆ†æƒé‡ã€‚`,
        features: ["å›¢è´­è®¢å•è‡ªåŠ¨æ ¸é”€", "é¢„çº¦æ’ç­åŒå‘åŒæ­¥", "è¯„ä»·é›†ä¸­å›å¤ç®¡ç†", "å¤šé—¨åº—ä¸€é”®ç»‘å®š"], benefits: ["ä½æˆæœ¬è·å–å…¬åŸŸæµé‡", "ç®€åŒ–å‰å°æ ¸é”€æµç¨‹", "é¿å…è¶…å–å’Œæ’å•"], reviews: [MOCK_REVIEWS[3]], guarantee: "å®˜æ–¹æ¥å£è®¤è¯ï¼Œç¨³å®šä¸æ‰å•"
    },
    {
        id: "family_doc", title: "å®¶åº­åŒ»ç”Ÿç­¾çº¦ç³»ç»Ÿ", description: "ç´§è·Ÿå›½å®¶æ”¿ç­–çº¢åˆ©ã€‚ç­¾çº¦ã€å±¥çº¦å…¨æµç¨‹ç”µå­åŒ–ï¼Œå…¬å«æ•°æ®è‡ªåŠ¨ä¸Šä¼ ï¼Œè½»æ¾æ‹¿è¡¥è´´ã€‚",
        price: 2500, type: "software", rating: 4.5, reviewsCount: 45, minVersionRequired: "ä¸“ä¸šç‰ˆ",
        isOwned: false, tags: ["æ”¿ç­–çº¢åˆ©", "ç¤¾åŒºæœåŠ¡"], imageColor: "bg-emerald-100", scope: "all_stores",
        markdownContent: `## å“åº”å›½å®¶å·å¬ï¼Œåšç¤¾åŒºå¥åº·çš„å®ˆé—¨äºº\n\nåšå…¬å«æœåŠ¡ã€å®¶åº­åŒ»ç”Ÿç­¾çº¦ï¼Œæœ€æ€•çº¸è´¨æ¡£æ¡ˆå †ç§¯å¦‚å±±ï¼Œè€ƒæ ¸æ—¶æ‰¾ä¸åˆ°æ•°æ®ã€‚**æœ¬ç³»ç»Ÿè®©ç­¾çº¦ã€å±¥çº¦å…¨æµç¨‹ç”µå­åŒ–ï¼Œæ•°æ®ä¸€ç›®äº†ç„¶ã€‚**\n\n![å®¶åŒ»ç­¾çº¦å¤§å±](placeholder-family-doc)\n\n## åŠŸèƒ½äº®ç‚¹\n- **ç”µå­ç­¾çº¦**ï¼šæå‡ºæ‰‹æœºæ‰«ä¸€æ‰«å°±èƒ½ç­¾çº¦ï¼Œä¸ç”¨å†æ‰“å°åšåšçš„çº¸è´¨åè®®ã€‚\n- **å±¥çº¦è·Ÿè¸ª**ï¼šç³»ç»Ÿè‡ªåŠ¨æé†’â€œå¼ å¤§çˆ·è¯¥æµ‹è¡€å‹äº†â€ï¼ŒæœåŠ¡ä¸é—æ¼ï¼Œè€ƒæ ¸è½»æ¾è¿‡ã€‚\n- **æ•°æ®å¯¹æ¥**ï¼šç¬¦åˆå›½å®¶å…¬å«æ¥å£æ ‡å‡†ï¼Œæ•°æ®è‡ªåŠ¨ä¸Šä¼ å…¬å«å¹³å°ã€‚`,
        features: ["ç”µå­åè®®ç§»åŠ¨ç«¯ç­¾ç½²", "ä¸ªæ€§åŒ–æœåŠ¡åŒ…å®šä¹‰", "å±¥çº¦è¿›åº¦æ™ºèƒ½è¿½è¸ª", "å…¬å«æŠ¥è¡¨ä¸€é”®å¯¼å‡º"], benefits: ["é¡ºåˆ©é€šè¿‡å…¬å«è€ƒæ ¸", "æ·±åº¦é”å®šç¤¾åŒºå±…æ°‘", "å‡å°‘æ–‡ä¹¦å·¥ä½œæ—¶é—´"], reviews: [], trialDays: 15
    },
    // --- 3. æ•ˆç‡ä¸åˆè§„ ---
    {
        id: "e_invoice", title: "æ•°ç”µå‘ç¥¨æ¥å£", description: "åˆ«å†ä¹°æ‰“å°æœºäº†ï¼æ‰‹æœºä¸€é”®å¼€ç¥¨ï¼Œæ— éœ€ç¨æ§ç›˜ï¼Œæ¯å¹´çœä¸‹å‡ åƒå…ƒè€—æè´¹ã€‚",
        price: 500, type: "service", rating: 4.9, reviewsCount: 88, minVersionRequired: "åŸºç¡€ç‰ˆ",
        isOwned: false, tags: ["é™æœ¬å¢æ•ˆ", "è´¢åŠ¡åˆè§„"], imageColor: "bg-indigo-100", scope: "per_store", 
        markdownContent: `## ä¸ºä»€ä¹ˆè¿˜è¦å¿å—é’ˆå¼æ‰“å°æœºçš„å™ªéŸ³ï¼Ÿ\n\nä¼ ç»Ÿçš„å‘ç¥¨æ‰“å°ä¸ä»…æ…¢ï¼Œè¿˜è¦ä¹°æ˜‚è´µçš„æ‰“å°æœºã€è‰²å¸¦ã€çº¸å¼ ï¼Œè¿˜å¾—ä¸“äººä¿ç®¡ç¨æ§ç›˜ã€‚**å…¨ç”µå‘ç¥¨æ—¶ä»£ï¼Œå¼€ç¥¨åº”è¯¥åƒå‘çŸ­ä¿¡ä¸€æ ·ç®€å•ã€‚**\n\n![ç”µå­å‘ç¥¨ç¤ºä¾‹](placeholder-invoice)\n\n## ç”µå­å‘ç¥¨å¥½åœ¨å“ªï¼Ÿ\n- **æå…¶çœé’±**ï¼šä¸éœ€è¦ä¹°å‡ åƒå—çš„æ‰“å°æœºï¼Œä¹Ÿä¸éœ€è¦æ¯å¹´ä¹°çº¸ï¼Œå¼€ç¥¨æˆæœ¬å‡ ä¹ä¸º 0ã€‚\n- **æå…¶æ–¹ä¾¿**ï¼šæ‚£è€…ä»˜å®Œæ¬¾ï¼Œæ‰‹æœºä¸Šç›´æ¥æ”¶åˆ°å‘ç¥¨é“¾æ¥ï¼Œä¸ç”¨åœ¨çª—å£å‚»ç­‰ã€‚\n- **è´¢åŠ¡åˆè§„**ï¼šç›´æ¥å¯¹æ¥ç¨åŠ¡å±€æ¥å£ï¼Œè‡ªåŠ¨æŠ¥ç¨ï¼Œå‡å°‘è´¢åŠ¡é£é™©ã€‚`,
        features: ["è®¢å•è‡ªåŠ¨è§¦å‘å¼€ç¥¨", "çŸ­ä¿¡/å¾®ä¿¡/é‚®ç®±å¤šé€šé“æ¨é€", "çº¢å†²/ä½œåºŸåœ¨çº¿ç®¡ç†", "ç¨åŠ¡å±€ç›´è¿æ¥å£"], benefits: ["æ¯å¹´èŠ‚çœ3000+å…ƒè€—æ", "å‰å°ä¸å†æ‰‹å¿™è„šä¹±", "æå‡æ‚£è€…æ»¡æ„åº¦"], reviews: [], guarantee: "ç¨åŠ¡æ¥å£æŠ€æœ¯ä¿éšœ"
    },
    {
        id: "dual_net", title: "åŒ»ä¿/HIS åŒç½‘é€šæ’ä»¶", description: "ä¸€å¼ ç½‘å¡ï¼Œä¸¤ä¸ªä¸–ç•Œã€‚ä¸€å°ç”µè„‘åŒæ—¶è¿åŒ»ä¿ä¸“ç½‘å’Œäº’è”ç½‘ï¼ŒåŒ»ç”Ÿä¸ç”¨å†åƒâ€œæ‰“ç¢Ÿâ€ä¸€æ ·åˆ‡æ¢ç”µè„‘ã€‚",
        price: 800, type: "software", rating: 4.8, reviewsCount: 210, minVersionRequired: "ä¸“ä¸šç‰ˆ",
        isOwned: false, tags: ["çœç¡¬ä»¶", "æ•ˆç‡æå‡"], imageColor: "bg-indigo-50", scope: "per_store",
        markdownContent: `## ä½ çš„åŒ»ç”Ÿæ¡Œä¸Šæ˜¯ä¸æ˜¯æœ‰ä¸¤å°ç”µè„‘ï¼Ÿ\n\nä¸€å°å¼€åŒ»ä¿ï¼Œä¸€å°çœ‹ç—…å†ï¼ŒåŒ»ç”Ÿçœ‹ç—…åƒâ€œæ‰“ç¢Ÿâ€ä¸€æ ·è½¬æ¥è½¬å»ï¼Œæ—¢å åœ°æ–¹åˆä½æ•ˆã€‚**åŒç½‘é€šæ’ä»¶ï¼Œè®©æ‚¨çš„ä¸€å°ç”µè„‘åŒæ—¶è¿æ¥åŒ»ä¿ä¸“ç½‘å’Œäº’è”ç½‘ã€‚**\n\n![åŒç½‘é€šç¤ºæ„å›¾](placeholder-network)\n\n## æ ¸å¿ƒä»·å€¼\n- **çœä¸‹ä¸€åŠç¡¬ä»¶è´¹**ï¼šæ¯ä¸ªè¯Šå®¤å°‘ä¹°ä¸€å°ç”µè„‘ï¼Œå°‘æ‹‰ä¸€æ ¹ç½‘çº¿ï¼Œç®—ç®—è¿™ç¬”è´¦ï¼Ÿ\n- **æ“ä½œè¡Œäº‘æµæ°´**ï¼šåŒ»ç”Ÿåœ¨åŒä¸€ä¸ªç•Œé¢é‡Œå®Œæˆå¼€è¯å’ŒåŒ»ä¿ç»“ç®—ï¼Œä¸éœ€è¦åˆ‡æ¢é¼ æ ‡é”®ç›˜ï¼Œå¿ƒæƒ…éƒ½å˜å¥½äº†ã€‚\n- **æ•°æ®è‡ªåŠ¨æ˜ å°„**ï¼šHIS é‡Œçš„å¤„æ–¹è‡ªåŠ¨é£å…¥åŒ»ä¿ç³»ç»Ÿï¼Œä¸ç”¨é‡å¤å½•å…¥ã€‚`,
        features: ["å•æœºåŒç½‘å¹¶å‘æŠ€æœ¯", "å…¼å®¹ä¸»æµåŒ»ä¿è¯»å¡å™¨", "è¯å“ç›®å½•è‡ªåŠ¨æ˜ å°„", "ä¸€é”®åˆ‡æ¢ç½‘ç»œç¯å¢ƒ"], benefits: ["èŠ‚çœ50%ç¡¬ä»¶æŠ•å…¥", "åŒ»ç”Ÿæ“ä½œä¸å‰²è£‚", "è¯Šå®¤æ¡Œé¢æ›´æ•´æ´"], reviews: [], trialDays: 3, guarantee: "æ— æ•ˆå…¨é¢é€€æ¬¾"
    },
    {
        id: "multi_warehouse", title: "å¤šåº“æˆ¿/è¯æˆ¿ç®¡ç†ç³»ç»Ÿ", description: "ç®¡å¥½æ¯ä¸€ç²’è¯çš„å»å‘ã€‚å¤šçº§åº“æˆ¿ç‹¬ç«‹æ ¸ç®—ï¼Œæ™ºèƒ½è°ƒæ‹¨ï¼Œå¤§å‹è¯Šæ‰€/è¿é”æœºæ„å¿…å¤‡ã€‚",
        price: 2500, type: "software", rating: 4.6, reviewsCount: 68, minVersionRequired: "æ——èˆ°ç‰ˆ",
        isOwned: false, tags: ["åº“å­˜ç²¾å‡†", "å¤§å‹æœºæ„"], imageColor: "bg-slate-200", scope: "per_store",
        markdownContent: `## è¯æˆ¿è´¦ç›®æ€»æ˜¯ä¸å¹³ï¼Ÿ\n\nå¯¹äºä¸­å¤§å‹è¯Šæ‰€ï¼Œä¸€ä¸ªâ€œæ€»åº“å­˜â€æ ¹æœ¬ä¸å¤Ÿç”¨ã€‚è¥¿è¯æˆ¿ã€ä¸­è¯æˆ¿ã€æ²»ç–—å®¤ã€ä»“åº“...è¯å“åœ¨å“ªé‡Œæ¶ˆè€—çš„ï¼Ÿå“ªé‡Œç§¯å‹äº†ï¼Ÿ**å¤šåº“æˆ¿ç³»ç»Ÿå¸®æ‚¨æŠŠæ¯ä¸€ç²’è¯çš„å»å‘ç®¡å¾—æ¸…æ¸…æ¥šæ¥šã€‚**\n\n![å¤šåº“æˆ¿ç®¡ç†ç•Œé¢](placeholder-warehouse)\n\n## æ ¸å¿ƒåŠŸèƒ½\n- **ç‹¬ç«‹æ ¸ç®—**ï¼šæ¯ä¸ªç§‘å®¤/è¯æˆ¿éƒ½æœ‰è‡ªå·±çš„ç‹¬ç«‹è´¦æœ¬ï¼Œè´£ä»»åˆ°äººã€‚\n- **æ™ºèƒ½è°ƒæ‹¨**ï¼šè¯æˆ¿ç¼ºè´§äº†ï¼Ÿä¸€é”®å‘æ€»åº“å‘èµ·â€œé¢†è¯ç”³è¯·â€ï¼Œæµç¨‹è§„èŒƒï¼Œç—•è¿¹å¯æŸ¥ã€‚\n- **æ•ˆæœŸé¢„è­¦**ï¼šå“ªæ‰¹è¯å¿«è¿‡æœŸäº†ï¼Œç³»ç»Ÿæå‰ 3 ä¸ªæœˆå¼¹çª—æŠ¥è­¦ï¼Œä¼˜å…ˆå‘è´§ï¼Œå‡å°‘æŸè€—ã€‚`,
        features: ["å¤šçº§åº“æˆ¿æ¶æ„æ”¯æŒ", "åº“é—´è°ƒæ‹¨å®¡æ‰¹æµç¨‹", "ç§‘å®¤ç‹¬ç«‹ç›˜ç‚¹ä½œä¸š", "ä½åº“å­˜è‡ªåŠ¨ç”Ÿæˆé‡‡è´­å•"], benefits: ["åº“å­˜å‡†ç¡®ç‡æå‡è‡³99.9%", "å‡å°‘è¯å“è¿‡æœŸæŸè€—", "é˜²æ­¢å†…éƒ¨è·‘å†’æ»´æ¼"], reviews: [MOCK_REVIEWS[3]], trialDays: 15
    },
    {
        id: "smart_pharmacy", title: "æ™ºèƒ½åˆç†ç”¨è¯ (å®¡æ–¹ç³»ç»Ÿ)", description: "ç»™åŒ»ç”Ÿé…ä¸€ä¸ªâ€œAI è¯å‰‚å¸ˆâ€ã€‚è‡ªåŠ¨æ£€æŸ¥é…ä¼ç¦å¿Œã€è¶…é‡ç”¨è¯ï¼ŒæŠŠåŒ»ç–—äº‹æ•…æ‰¼æ€åœ¨æ‘‡ç¯®é‡Œã€‚",
        price: 1500, type: "software", rating: 4.9, reviewsCount: 300, minVersionRequired: "ä¸“ä¸šç‰ˆ",
        isOwned: false, tags: ["åŒ»ç–—å®‰å…¨", "æ–°æ‰‹è¾…åŠ©"], imageColor: "bg-red-50", scope: "all_stores",
        markdownContent: `## åŒ»ç”Ÿæ‰‹æŠ–å¼€é”™è¯ï¼Œåæœè°æ‰¿æ‹…ï¼Ÿ\n\näººéåœ£è´¤ï¼Œå­°èƒ½æ— è¿‡ã€‚ä½†åœ¨åŒ»ç–—è¡Œä¸šï¼Œä¸€ä¸ªå°å°çš„ç–å¿½å¯èƒ½å¼•å‘å·¨é¢èµ”å¿ã€‚**æ™ºèƒ½å®¡æ–¹ç³»ç»Ÿå°±åƒä¸€é“â€œå®‰å…¨é˜²ç«å¢™â€ï¼ŒæŠŠé”™è¯¯çš„å¤„æ–¹æ‹¦åœ¨å‘è¯ä¹‹å‰ã€‚**\n\n![å®¡æ–¹æ‹¦æˆªå¼¹çª—](placeholder-pharmacy-check)\n\n## å››é‡å®‰å…¨æ‹¦æˆª\n- **è¶…é‡æé†’**ï¼šå¤´å­¢ä¸€å¤©å¼€äº† 4 æ¬¡ï¼Ÿç³»ç»Ÿç«‹é©¬å¼¹çª—è­¦å‘Šã€‚\n- **é…ä¼ç¦å¿Œ**ï¼šå¼€äº†å¤´å­¢åˆå¼€äº†è—¿é¦™æ­£æ°”æ°´ï¼ˆå«é…’ç²¾ï¼‰ï¼Ÿç«‹åˆ»æ‹¦æˆªï¼Œé˜²æ­¢åŒç¡«ä»‘ååº”ã€‚\n- **ç‰¹æ®Šäººç¾¤**ï¼šç»™å­•å¦‡å¼€äº†ç¦ç”¨è¯ï¼Ÿç³»ç»Ÿæ¯”äººæ›´ç»†å¿ƒã€‚\n- **ç›¸äº’ä½œç”¨**ï¼šå¤šç§è¯ä¸€èµ·åƒä¼šä¸ä¼šæ‰“æ¶ï¼ŸAI æŸ¥å¾—æ¯”ä¹¦å¿«ã€‚`,
        features: ["30ä¸‡+ è¯å“è§„åˆ™åº“", "é…ä¼ç¦å¿Œå®æ—¶å®¡æŸ¥", "ç‰¹æ®Šäººç¾¤ç”¨è¯ç­›æŸ¥", "ç”µå­è¯´æ˜ä¹¦ä¸€é”®è°ƒé˜…"], benefits: ["æå¤§é™ä½åŒ»ç–—çº çº·é£é™©", "è§„èŒƒåŒ»ç”Ÿå¤„æ–¹è¡Œä¸º", "æ–°æ‰‹åŒ»ç”Ÿä¹Ÿèƒ½æ”¾å¿ƒå¼€è¯"], reviews: [], trialDays: 30
    },
    {
        id: "compliance_guard", title: "åŒ»ä¿åˆè§„å«å£«", description: "åˆ«è®©è¾›è‹¦é’±è¢«ç½šæ²¡äº†ï¼ä¸Šä¼ åŒ»ä¿å‰è‡ªåŠ¨â€œä½“æ£€â€ï¼Œé¢„è­¦è¿è§„é¡¹ï¼Œé™ä½åŒ»ä¿æ‹’ä»˜å’Œç½šæ¬¾é£é™©ã€‚",
        price: 1980, type: "software", rating: 4.8, reviewsCount: 150, minVersionRequired: "ä¸“ä¸šç‰ˆ",
        isOwned: false, tags: ["é˜²ç½šæ¬¾", "åŒ»ä¿é£æ§"], imageColor: "bg-blue-200", scope: "all_stores",
        markdownContent: `## åŒ»ä¿æ£€æŸ¥è¶Šæ¥è¶Šä¸¥ï¼Œä½ æ€•ä¸æ€•ï¼Ÿ\n\nå¾ˆå¤šè¯Šæ‰€å› ä¸ºä¸äº†è§£åŒ»ä¿è§„åˆ™ï¼Œæ— æ„ä¸­è¿è§„ï¼Œå¯¼è‡´**è¾›è‹¦èµšçš„é’±è¢«æ‰£æ¬¾ï¼Œç”šè‡³é¢ä¸´å‡ å€ç½šæ¬¾**ã€‚åˆè§„å«å£«å¸®æ‚¨åœ¨ä¸Šä¼ åŒ»ä¿å‰ï¼Œå…ˆåšä¸€æ¬¡â€œè‡ªæŸ¥ä½“æ£€â€ã€‚\n\n![åˆè§„æ£€æŸ¥æŠ¥å‘Š](placeholder-compliance)\n\n## å®ƒæŸ¥ä»€ä¹ˆï¼Ÿ\n- **é™é€‚åº”ç—‡ç”¨è¯**ï¼šæ¯”å¦‚è¿™è¯åªèƒ½ç»™é‡ç—‡ç”¨ï¼Œä½ ç»™è½»ç—‡å¼€äº†ï¼Ÿæ‹¦æˆªï¼\n- **æ€§åˆ«/å¹´é¾„é™åˆ¶**ï¼šç»™ç”·æ€§å¼€äº†å¦‡ç§‘è¯ï¼Ÿæ‹¦æˆªï¼\n- **è¿‡åº¦è¯Šç–—**ï¼šæ„Ÿå†’å¼€äº†å…¨å¥—ç”ŸåŒ–æ£€æŸ¥ï¼Ÿé¢„è­¦ï¼\n- **é¢‘æ¬¡é™åˆ¶**ï¼šç†ç–—é¡¹ç›®ä¸€å¤©åšäº† 5 æ¬¡ï¼Ÿæç¤ºé£é™©ï¼`,
        features: ["åŒ»ä¿è§„åˆ™åº“æ¯å‘¨å®æ—¶æ›´æ–°", "äº‹å‰/äº‹ä¸­å®æ—¶æé†’", "è¿è§„é£é™©çº¢é»„ç¯åˆ†çº§", "æ•´æ”¹å»ºè®®æŠ¥å‘Šç”Ÿæˆ"], benefits: ["é™ä½åŒ»ä¿æ‰£æ¬¾ç‡90%", "æå‡ç—…å†ä¹¦å†™è´¨é‡", "ç»è¥è€…ç¡å¾—å®‰ç¨³"], reviews: [], trialDays: 15
    },
    {
        id: "kiosk_sw", title: "è‡ªåŠ©æœåŠ¡æœºç³»ç»Ÿ", description: "é›‡ä¸€ä¸ªä¸çŸ¥ç–²å€¦çš„â€œè¶…çº§å‰å°â€ã€‚åˆ†æµé«˜å³°äººç¾¤ï¼Œæ‚£è€…è‡ªåŠ©æŒ‚å·ã€ç¼´è´¹ã€æ‰“æŠ¥å‘Šï¼Œçœäººå·¥åˆæ°”æ´¾ã€‚",
        price: 4800, type: "hardware", rating: 4.5, reviewsCount: 30, minVersionRequired: "æ——èˆ°ç‰ˆ",
        isOwned: false, tags: ["åˆ†æµç¥å™¨", "æå‡æ¡£æ¬¡"], imageColor: "bg-gray-100", scope: "per_store", 
        markdownContent: `## æ—©é«˜å³°å¤§å…æŒ¤å¾—æ°´æ³„ä¸é€šï¼Ÿ\n\nä¸å…¶å†æ‹›ä¸¤ä¸ªå‰å°ï¼Œä¸å¦‚æ·»ç½®ä¸€å°è‡ªåŠ©æœºã€‚å®ƒä¸è¯·å‡ã€ä¸æŠ±æ€¨ã€ä¸å‘è„¾æ°”ï¼Œ**ä¸€å°æœºå™¨èƒ½é¡¶ 2 ä¸ªç†Ÿç»ƒæŒ‚å·å‘˜**ã€‚\n\n![è‡ªåŠ©æœºå®æ‹](placeholder-kiosk)\n\n## å®ƒèƒ½å¹²ä»€ä¹ˆï¼Ÿ\n- **è‡ªåŠ©å»ºæ¡£**ï¼šæ‚£è€…åˆ·èº«ä»½è¯ï¼Œ1 ç§’é’Ÿå®Œæˆå»ºæ¡£ï¼Œä¸ç”¨å‰å°æ‰‹æ•²ã€‚\n- **è‡ªåŠ©ç¼´è´¹**ï¼šæ”¯æŒå¾®ä¿¡æ”¯ä»˜å®ï¼Œä¸ç”¨æ’é˜Ÿäº¤ç°é‡‘ã€‚\n- **æŠ¥å‘Šæ‰“å°**ï¼šæ£€æŸ¥ç»“æœå‡ºæ¥ï¼Œæ‚£è€…æ‰«ç è‡ªå–ï¼Œä¿æŠ¤éšç§åˆå¿«æ·ã€‚`,
        features: ["èº«ä»½è¯/åŒ»ä¿å¡æé€Ÿè¯†åˆ«", "èšåˆæ”¯ä»˜æ‰«ç ç¼´è´¹", "A4/A5 æŠ¥å‘Šè‡ªåŠ©æ‰“å°", "å‘ç¥¨è‡ªåŠ©æ‰“å°"], benefits: ["å¤§å¹…å‡å°‘å‰å°æ’é˜Ÿ", "é™ä½äººåŠ›æˆæœ¬", "æå‡è¯Šæ‰€ç§‘æŠ€æ„Ÿ"], reviews: [], guarantee: "ç¡¬ä»¶ä¸€å¹´è´¨ä¿ï¼Œè½¯ä»¶ç»ˆèº«å‡çº§"
    },
    // --- 4. ä¸“ç§‘èƒ½åŠ› ---
    {
        id: "child_care", title: "å„¿ä¿è·Ÿè¸ªç³»ç»Ÿ", description: "æ˜é‡‘å„¿ç«¥å¥åº·ç®¡ç†è“æµ·ã€‚WHOæ ‡å‡†ç”Ÿé•¿æ›²çº¿ï¼Œä¸“ä¸šæ™ºåŠ›/è¡Œä¸ºè¯„ä¼°ï¼Œæå‡å„¿ç§‘å®¢å•ä»·å’Œç²˜æ€§ã€‚",
        price: 3600, type: "software", rating: 4.8, reviewsCount: 76, minVersionRequired: "ä¸“ä¸šç‰ˆ",
        isOwned: false, tags: ["é«˜å®¢å•ä»·", "å„¿ç§‘ç‰¹è‰²"], imageColor: "bg-yellow-100", scope: "per_store", 
        markdownContent: `## åˆ«åªèµšå–è¯çš„è¾›è‹¦é’±ï¼Œå„¿ä¿æ‰æ˜¯é‡‘çŸ¿\n\nç°åœ¨çš„å®¶é•¿æœ€èˆå¾—ç»™å­©å­èŠ±é’±ã€‚ä»å•çº¯çš„â€œç”Ÿç—…æ‰æ¥â€ï¼Œè½¬å‹ä¸º**â€œä¸ºäº†ä¸ç”Ÿç—…ã€é•¿å¾—é«˜ã€æ›´èªæ˜è€Œæ¥â€**çš„é«˜é™„åŠ å€¼å„¿ç«¥å¥åº·ç®¡ç†ä¸­å¿ƒã€‚\n\n![ç”Ÿé•¿æ›²çº¿å›¾](placeholder-child-growth)\n\n## ä¸“ä¸šåŠŸèƒ½\n- **ç”Ÿé•¿å‘è‚²å¯è§†åŒ–**ï¼šè¾“å…¥èº«é«˜ä½“é‡ï¼Œè‡ªåŠ¨ç”Ÿæˆ WHO æ ‡å‡†ç”Ÿé•¿æ›²çº¿å›¾ï¼Œå®¶é•¿ä¸€çœ‹å°±æ‡‚ã€‚\n- **ä¸“ä¸šæµ‹è¯„é‡è¡¨**ï¼šå†…ç½® DST æ™ºåŠ›ç­›æŸ¥ã€å¤šåŠ¨ç—‡è¯„ä¼°ã€è†³é£Ÿè¥å…»åˆ†æç­‰ 50+ ç§é‡è¡¨ï¼Œæ”¶è´¹é¡¹ç›®æ›´å¤šå…ƒã€‚\n- **ç²¾ç¾æŠ¥å‘Š**ï¼šç”Ÿæˆå›¾æ–‡å¹¶èŒ‚çš„è¯„ä¼°æŠ¥å‘Šï¼Œå®¶é•¿æ„¿æ„ä¸ºæ­¤ä¹°å•ï¼Œå‘æœ‹å‹åœˆä¹Ÿæ˜¯æœ€å¥½çš„å¹¿å‘Šã€‚`,
        features: ["WHO/ä¸­å›½ä¹å¸‚ç”Ÿé•¿æ ‡å‡†æ›²çº¿", "50+ç§ä¸“ä¸šæµ‹è¯„é‡è¡¨", "è†³é£Ÿè¥å…»åˆ†æå·¥å…·", "ç²¾ç¾å½©è‰²æŠ¥å‘Šæ‰“å°"], benefits: ["æ‹“å±•é«˜æ¯›åˆ©æ”¶è´¹é¡¹ç›®", "æå¤§å¢åŠ å„¿ç§‘ç”¨æˆ·ç²˜æ€§", "æå‡å®¶é•¿æ»¡æ„åº¦"], reviews: [MOCK_REVIEWS[1]], trialDays: 7
    },
    {
        id: "dental_pro", title: "ç‰™ç§‘ä¸“ä¸šåŒ… (ä¹‰é½¿/ä¸“ç§‘ç—…å†)", description: "ç‰™ç§‘è¯Šæ‰€çš„â€œç¥å…µåˆ©å™¨â€ã€‚3Dç‰™ä½å›¾ä¸€é”®æ ‡è®°ï¼Œä¹‰é½¿å¤–å‘å…¨æµç¨‹è¿½è¸ªï¼Œæœç»ä¸¢ä»¶æ¼ä»¶ã€‚",
        price: 4500, type: "software", rating: 4.9, reviewsCount: 88, minVersionRequired: "ä¸“ä¸šç‰ˆ", 
        isOwned: false, tags: ["ç‰™ç§‘ä¸“ç”¨", "ç²¾ç»†ç®¡ç†"], imageColor: "bg-sky-100", scope: "per_store",
        markdownContent: `## é€šç”¨ç—…å†å†™ä¸äº†ç‰™ç§‘çš„ç—›\n\nç‰™ç§‘åŒ»ç”Ÿæœ€å¤´ç–¼çš„æ˜¯ä»€ä¹ˆï¼Ÿå†™ç—…å†ç”»ç‰™ä½å›¾å¤ªéš¾ï¼ä¹‰é½¿é€å»åŠ å·¥å‚æ‰¾ä¸åˆ°äº†ï¼**è¿™æ˜¯ä¸“ä¸ºå£è…”è¯Šæ‰€æ‰“é€ çš„ä¸“ä¸šæ’ä»¶ã€‚**\n\n![ç‰™ä½å›¾ç—…å†](placeholder-dental)\n\n## ç‰™ç§‘ä¸“å±åŠŸèƒ½\n- **3D ç‰™ä½å›¾**ï¼šç›´æ¥ç‚¹å‡»ç‰™é½¿æ¨¡å‹ï¼Œå“ªé‡Œæœ‰æ´ç‚¹å“ªé‡Œï¼Œè‡ªåŠ¨ç”Ÿæˆä¸“ä¸šçš„ç‰™ä½æè¿°ã€‚\n- **ä¹‰é½¿åŠ å·¥ç®¡ç†**ï¼šæ‰«ç å‡ºåº“ï¼ŒåŠ å·¥å‚æ”¶è´§ã€åˆ¶ä½œã€å‘å›å…¨æµç¨‹æ‰«ç è¿½è¸ªï¼Œæœç»ä¹‰é½¿ä¸¢ä»¶ã€‚\n- **ç§æ¤/æ­£ç•¸ä¸“ç§‘ç—…å†**ï¼šå†…ç½®ä¸“ç§‘æ¨¡æ¿ï¼Œå¤æ‚ç—…ç¨‹ç®¡ç†äº•äº•æœ‰æ¡ã€‚`,
        features: ["å¯è§†3Dç‰™ä½å›¾æ ‡è®°", "ä¹‰é½¿å¤–å‘/å›ä»¶æ‰«ç è¿½è¸ª", "æ­£ç•¸/ç§æ¤å…¨å‘¨æœŸç—…å†", "æœ¯åè‡ªåŠ¨å›è®¿è®¡åˆ’"], benefits: ["æœç»ä¹‰é½¿ä¸¢ä»¶èµ”å¿", "ç—…å†è§„èŒƒä¸“ä¸š", "æå‡ç‰™åŒ»å·¥ä½œæ•ˆç‡"], reviews: [], guarantee: "å«ç‰™ä½å›¾ç»„ä»¶æ°¸ä¹…å‡çº§"
    },
    {
        id: "pe_system", title: "ä¸“ä¸šä½“æ£€ç³»ç»Ÿ", description: "æƒ³è¦æ¥ä¼ä¸šå›¢æ£€å¤§å•ï¼Ÿä½ éœ€è¦è¿™ä¸ªã€‚æ”¯æŒåˆ†ç§‘å®¤å½•å…¥ï¼Œè‡ªåŠ¨ç”Ÿæˆæ€»æ£€æŠ¥å‘Šï¼Œæµç¨‹æ ‡å‡†åŒ–ã€‚",
        price: 4800, type: "software", rating: 4.5, reviewsCount: 50, minVersionRequired: "æ——èˆ°ç‰ˆ",
        isOwned: false, tags: ["å›¢æ£€ä¸šåŠ¡", "æµç¨‹ç®¡ç†"], imageColor: "bg-lime-100", scope: "per_store", 
        markdownContent: `## æƒ³è¦æ¥ä¼ä¸šä½“æ£€å•ï¼Ÿç”¨é—¨è¯Šç³»ç»Ÿè‚¯å®šä¸è¡Œ\n\nä½“æ£€ä¸šåŠ¡å’Œçœ‹ç—…æµç¨‹å®Œå…¨ä¸åŒï¼Œéœ€è¦é«˜æ•ˆçš„æµæ°´çº¿ä½œä¸šã€‚**æˆ‘ä»¬çš„ä½“æ£€ç³»ç»Ÿå¸®æ‚¨æŠŠâ€œä½“æ£€ç”Ÿæ„â€æ ‡å‡†åŒ–ã€æµç¨‹åŒ–ã€‚**\n\n![ä½“æ£€æŠ¥å‘Šç¤ºä¾‹](placeholder-pe-report)\n\n## å®Œæ•´æµç¨‹è¦†ç›–\n- **æ£€å‰å¯¼å…¥**ï¼šä¼ä¸šå‘æ¥ 100 äººçš„ Excel åå•ï¼Œä¸€é”®å¯¼å…¥ç³»ç»Ÿï¼Œè‡ªåŠ¨åˆ†ç»„ã€‚\n- **åˆ†ç§‘å®¤ä½œä¸š**ï¼šå†…ç§‘ã€å¤–ç§‘ã€çœ¼ç§‘åŒ»ç”Ÿå„å¸å…¶èŒï¼Œåªçœ‹è‡ªå·±çš„å½•å…¥ç•Œé¢ã€‚\n- **æ€»æ£€æ±‡æ€»**ï¼šæ‰€æœ‰ç§‘å®¤ç»“æœå‡ºæ¥åï¼Œç³»ç»Ÿè‡ªåŠ¨æ±‡æ€»ï¼Œç”Ÿæˆå¼‚å¸¸é¡¹å°ç»“å’Œç»¼è¿°å»ºè®®ã€‚`,
        features: ["ä¼ä¸šå›¢æ£€åå•Excelå¯¼å…¥", "åˆ†ç§‘å®¤ç‹¬ç«‹æ“ä½œç•Œé¢", "æ€»æ£€è‡ªåŠ¨æ±‡æ€»ç”Ÿæˆå»ºè®®", "ä¸ªäºº/å›¢ä½“æŠ¥å‘Šæ‰¹é‡æ‰“å°"], benefits: ["æ‹“å±•ä¼ä¸šä½“æ£€ä¸šåŠ¡", "æå‡ä½“æ£€æµè½¬æ•ˆç‡", "æŠ¥å‘Šä¸“ä¸šè§„èŒƒ"], reviews: [], trialDays: 15
    },
    {
        id: "chronic_mgr", title: "æ…¢ç—…ç®¡ç†ç³»ç»Ÿ", description: "æŠŠâ€œä¸€æ¬¡æ€§â€æ‚£è€…å˜æˆâ€œç»ˆèº«â€æœ‹å‹ã€‚é«˜è¡€å‹/ç³–å°¿ç—…è‡ªåŠ¨å»ºæ¡£éšè®¿ï¼Œæå‡ä¾ä»æ€§ï¼Œå¤è¯Šç‡ç¿»å€ã€‚",
        price: 1980, type: "software", rating: 4.6, reviewsCount: 110, minVersionRequired: "ä¸“ä¸šç‰ˆ",
        isOwned: true, purchaseInfo: { expiryDate: '2025-06-01', status: 'active', usage: 'ç®¡ç†æ‚£è€… 580 äºº', authorizedStores: ['ä¸­å¿ƒåŒ»é™¢ - é—¨è¯Šéƒ¨'] },
        guideSteps: [{ title: "å»ºç«‹æ¡£æ¡ˆ", desc: "åœ¨é—¨è¯Šæ¥è¯Šæ—¶ï¼Œå‹¾é€‰ã€çº³å…¥æ…¢ç—…ç®¡ç†ã€‘ï¼Œç³»ç»Ÿè‡ªåŠ¨å»ºæ¡£ã€‚" }, { title: "åˆ¶å®šè®¡åˆ’", desc: "é€‰æ‹©ç³»ç»Ÿæ¨èçš„é«˜è¡€å‹/ç³–å°¿ç—…éšè®¿æ¨¡æ¿ã€‚" }, { title: "æ‰§è¡Œéšè®¿", desc: "ç³»ç»Ÿæ¯æ—¥æ¨é€éœ€éšè®¿åå•ï¼ŒæŠ¤å£«ç”µè¯æˆ–çŸ­ä¿¡å›è®¿ã€‚" }],
        tags: ["æ‚£è€…ç²˜æ€§", "å›½å®¶å…¬å«"], imageColor: "bg-red-100", scope: "all_stores", 
        markdownContent: `## ä¸ºä»€ä¹ˆç—…æ‚£æ‹¿å®Œè¯å°±ä¸æ¥äº†ï¼Ÿ\n\næ…¢ç—…æ‚£è€…éœ€è¦é•¿æœŸç®¡ç†ï¼Œæ˜¯åŸºå±‚åŒ»ç–—æœ€ç¨³å®šçš„æ”¶å…¥æ¥æºã€‚ä½†å¦‚æœæ²¡æœ‰ç®¡ç†ï¼Œä»–ä»¬å¾ˆå®¹æ˜“æµå¤±ã€‚**æ…¢ç—…ç³»ç»Ÿå¸®æ‚¨å»ºç«‹é•¿ä¹…çš„åŒ»æ‚£å…³ç³»ã€‚**\n\n![æ…¢ç—…æ¡£æ¡ˆ](placeholder-chronic)\n\n## ç³»ç»Ÿæ€ä¹ˆå¸®æ‚¨ç®¡ï¼Ÿ\n- **è‡ªåŠ¨å…¥ç»„**ï¼šåŒ»ç”Ÿè¯Šæ–­äº†â€œé«˜è¡€å‹â€ï¼Œç³»ç»Ÿè‡ªåŠ¨æç¤ºâ€œæ˜¯å¦çº³å…¥æ…¢ç—…ç®¡ç†â€ã€‚\n- **æ™ºèƒ½éšè®¿**ï¼šç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆéšè®¿è®¡åˆ’ï¼Œæ¯”å¦‚â€œ2å‘¨åç”µè¯å›è®¿â€ã€â€œ1ä¸ªæœˆåå¤æŸ¥è¡€ç³–â€ã€‚æŠ¤å£«æ¯å¤©ä¸Šç­åªéœ€ç…§ç€ä»»åŠ¡åˆ—è¡¨æ‰“ç”µè¯ã€‚\n- **æ•°æ®é¢„è­¦**ï¼šæ‚£è€…åœ¨å®¶æµ‹çš„è¡€å‹ä¸Šä¼ åï¼Œå¦‚æœè¿ç»­åé«˜ï¼ŒåŒ»ç”Ÿé©¬ä¸Šæ”¶åˆ°é¢„è­¦ï¼Œä¸»åŠ¨å¹²é¢„ã€‚`,
        features: ["æ…¢ç—…æ‚£è€…è‡ªåŠ¨è¯†åˆ«å…¥ç»„", "æ™ºèƒ½éšè®¿è®¡åˆ’å¼•æ“", "å¼‚å¸¸ä½“å¾æ³¢åŠ¨é¢„è­¦", "å…¬å«æ…¢ç—…æŠ¥è¡¨å¯¼å‡º"], benefits: ["æ˜¾è‘—æé«˜å¤è¯Šç‡", "å¢åŠ æ…¢ç—…è¯å“æ”¶å…¥", "æå‡æ‚£è€…ä¾ä»æ€§"], reviews: [], trialDays: 30
    },
    {
        id: "ai_diagnosis_adv", title: "AI è¾…åŠ©è¯Šç–— (é«˜çº§ç‰ˆ)", description: "å¹´è½»åŒ»ç”Ÿçš„â€œè€ä¸“å®¶â€å¯¼å¸ˆã€‚æ™ºèƒ½é—®è¯Šã€ç—…å†ç”Ÿæˆã€è¯Šæ–­æ¨èï¼Œå†™ç—…å†å¿«ä¸€å€ï¼Œè¯¯è¯Šç‡é™ä¸€åŠã€‚",
        price: 1200, type: "software", rating: 4.9, reviewsCount: 180, minVersionRequired: "åŸºç¡€ç‰ˆ",
        isOwned: false, tags: ["ç”µå­ç—…å†", "é£é™©æ§åˆ¶"], imageColor: "bg-violet-100", scope: "per_store", 
        markdownContent: `## åŸºå±‚åŒ»ç”Ÿç»éªŒå°‘ï¼Œä¸æ•¢çœ‹ç—…ï¼Ÿ\n\næ‹›è˜é«˜å¹´èµ„åŒ»ç”Ÿå¤ªéš¾ï¼Œå¹´è½»åŒ»ç”Ÿåˆæ€•çœ‹é”™ç—…ã€‚**AI è¾…åŠ©è¯Šç–—å°±åƒä¸€ä¸ªç»éªŒä¸°å¯Œçš„è€ä¸»ä»»ï¼Œååœ¨åŒ»ç”Ÿæ—è¾¹å®æ—¶æŒ‡å¯¼ã€‚**\n\n![AI è¾…åŠ©å¼¹çª—](placeholder-ai-help)\n\n## ä¸‰å¤§è¶…èƒ½åŠ›\n- **æ™ºèƒ½é—®è¯Š**ï¼šæ ¹æ®æ‚£è€…ä¸»è¯‰ï¼Œæç¤ºåŒ»ç”Ÿâ€œè¿˜éœ€è¦é—®ä»€ä¹ˆï¼Ÿâ€ï¼Œé˜²æ­¢æ¼è¯Šã€‚\n- **ç—…å†ç”Ÿæˆ**ï¼šç‚¹å‡ ä¸ªé€‰é¡¹ï¼Œè‡ªåŠ¨ç”Ÿæˆä¸€ç¯‡é€»è¾‘ä¸¥å¯†çš„æ ‡å‡†ç—…å†ï¼Œä¹¦å†™æ—¶é—´ç¼©çŸ­ 50%ã€‚\n- **è¯Šæ–­æ¨è**ï¼šæ ¹æ®ç—‡çŠ¶å’Œæ£€æŸ¥ç»“æœï¼ŒAI æ¨èæœ€å¯èƒ½çš„ 3 ä¸ªè¯Šæ–­ï¼Œä¾›åŒ»ç”Ÿå‚è€ƒã€‚`,
        features: ["ç—…å†æ™ºèƒ½æ¨¡æ¿ç”Ÿæˆ", "é‰´åˆ«è¯Šæ–­è¾…åŠ©æ¨è", "åˆç†ç”¨è¯å®æ—¶å®¡æŸ¥", "ç—…å†å†…æ¶µè´¨æ§æ‰“åˆ†"], benefits: ["é™ä½åŒ»ç–—é£é™©", "å¿«é€Ÿæå‡å¹´è½»åŒ»ç”Ÿæ°´å¹³", "ç—…å†ä¹¦å†™æ•ˆç‡ç¿»å€"], reviews: [MOCK_REVIEWS[0]], trialDays: 30, guarantee: "æ— æ•ˆé€€æ¬¾"
    },
    {
        id: "3", title: "ä¸“ç”¨æ¡ç æ‰“å°æœº G3", description: "ä¸“ä¸ºåŒ»ç–—é«˜è´Ÿè·åœºæ™¯è®¾è®¡ã€‚ä¸å¡çº¸ã€ä¸è¤ªè‰²ï¼Œæ ‡ç­¾æ‰“å¾—å¿«åˆæ¸…æ™°ï¼Œè¯æˆ¿æŠ¤å£«éƒ½å¤¸å¥½ç”¨ã€‚",
        price: 1200, type: "hardware", rating: 4.9, reviewsCount: 32, minVersionRequired: "åŸºç¡€ç‰ˆ",
        isOwned: false, tags: ["è€é€ ", "ä¸å¡çº¸"], imageColor: "bg-orange-100", scope: "per_store",
        markdownContent: `## ä¾¿å®œæ‰“å°æœºæ‰æ˜¯æœ€è´µçš„\n\næ™®é€šçš„å®¶ç”¨æ‰“å°æœºæ”¾åœ¨åŒ»é™¢é‡Œï¼Œå‡ å¤©å°±å¡çº¸ï¼Œçƒ­æ•çº¸æ‰“å‡ºæ¥å‡ å¤©å°±å˜ç™½äº†ï¼Œæ‚£è€…æ ¹æœ¬çœ‹ä¸æ¸…è¯æ€ä¹ˆåƒã€‚**G3 æ‰“å°æœºæ˜¯ä¸“ä¸ºåŒ»é™¢è¯æˆ¿é«˜é¢‘ã€é«˜å‹ç¯å¢ƒè®¾è®¡çš„ã€‚**\n\n![æ‰“å°æœºå®æ‹](placeholder-printer)\n\n## ç¡¬ä»¶å‚æ•°\n* **å·¥ä¸šçº§æ‰“å°å¤´**ï¼šå¯¿å‘½é•¿è¾¾ 50 å…¬é‡Œï¼Œæ˜¯æ™®é€šæœºå™¨çš„ 3 å€ã€‚\n* **æ™ºèƒ½æ ¡å‡†**ï¼šæ¢çº¸åè‡ªåŠ¨å¯¹é½ï¼Œç¬¬ä¸€å¼ çº¸ä¹Ÿä¸ä¼šæµªè´¹ã€‚\n* **å­—è¿¹æŒä¹…**ï¼šé…åˆä¸“ç”¨è€—æï¼Œè¯å“æ ‡ç­¾ 3 ä¸ªæœˆä¸è¤ªè‰²ã€‚`,
        features: ["å·¥ä¸šçº§è€ç£¨æ‰“å°å¤´", "æ”¯æŒç½‘å£/è“ç‰™/USBä¸‰æ¨¡", "ä¸€é”®æ™ºèƒ½æ ¡å‡†é˜²æµªè´¹", "è¿‡çƒ­ä¿æŠ¤è¿ç»­æ‰“å°"], benefits: ["å³æ’å³ç”¨", "å”®åæ— å¿§", "é™ä½è€—ææµªè´¹"], reviews: [], guarantee: "ä¸€å¹´åªæ¢ä¸ä¿®"
    },
    {
        id: "4", title: "VIP ä¸“å±å®¢æˆ·ç»ç†", description: "åƒç§äººåŒ»ç”Ÿä¸€æ ·çš„ç³»ç»Ÿç®¡å®¶ã€‚7x24å°æ—¶ä¸“çº¿å“åº”ï¼Œä¸å†æ‰“ 400 æ’é˜Ÿï¼Œé—®é¢˜ç§’çº§è§£å†³ã€‚",
        price: 2999, type: "service", rating: 5.0, reviewsCount: 12, minVersionRequired: "æ——èˆ°ç‰ˆ",
        isOwned: false, tags: ["æœåŠ¡", "è¿ç»´"], imageColor: "bg-purple-100", scope: "all_stores",
        markdownContent: `## ç³»ç»Ÿå‡ºé—®é¢˜ï¼Œæ¯ä¸€ç§’éƒ½åœ¨æŸå¤±é’±\n\næ™®é€šçš„å®¢æœç”µè¯éœ€è¦æ’é˜Ÿã€è½¬æ¥ï¼Œç­‰è½®åˆ°ä½ ï¼Œæ‚£è€…æ—©å°±èµ°å…‰äº†ã€‚**VIP æœåŠ¡ä¸ºæ‚¨æä¾›æœ€é«˜çº§åˆ«çš„ä¸šåŠ¡è¿ç»­æ€§ä¿éšœã€‚**\n\n### å°Šäº«æƒç›Š\n* **æé€Ÿå“åº”**ï¼šç›´æ¥æ‹¨æ‰“ VIP ä¸“çº¿ï¼Œä¸ç»è¿‡å‘¼å«ä¸­å¿ƒï¼Œç›´è¿èµ„æ·±å·¥ç¨‹å¸ˆã€‚\n* **ä¸»åŠ¨å·¡æ£€**ï¼šæ¯å­£åº¦ä¸€æ¬¡è¿œç¨‹æˆ–ä¸Šé—¨å·¡æ£€ï¼Œåœ¨æ•…éšœå‘ç”Ÿå‰è§£å†³éšæ‚£ã€‚\n* **ç»¿è‰²é€šé“**ï¼šæ‚¨çš„éœ€æ±‚ä¼šè¢«äº§å“å›¢é˜Ÿä¼˜å…ˆæ’æœŸå¼€å‘ã€‚`,
        features: ["1å¯¹1ä¸“å±æŠ€æœ¯é¡¾é—®", "å­£åº¦ä¸»åŠ¨å¥åº·å·¡æ£€", "ä¸ªæ€§åŒ–éœ€æ±‚ä¼˜å…ˆå¼€å‘", "ç´§æ€¥æƒ…å†µç°åœºæ”¯æŒ"], benefits: ["ä¸šåŠ¡æ°¸ä¸ä¸­æ–­", "ä¸ªæ€§åŒ–æŒ‡å¯¼", "ç»è¥æ— åé¡¾ä¹‹å¿§"], reviews: [],
    },
    {
        id: "5", title: "çŸ­ä¿¡é€šçŸ¥åŒ… (5000æ¡)", description: "ä½æˆæœ¬ã€é«˜åˆ°è¾¾çš„è§¦è¾¾å·¥å…·ã€‚å¤è¯Šæé†’ã€æ¬ è´¹é€šçŸ¥ã€èŠ‚æ—¥å…³æ€€ï¼Œä¸€æ¡çŸ­ä¿¡æ‰å‡ åˆ†é’±ã€‚",
        price: 200, type: "service", rating: 4.2, reviewsCount: 560, minVersionRequired: "åŸºç¡€ç‰ˆ",
        isOwned: false, tags: ["èµ„æºåŒ…"], imageColor: "bg-teal-100", scope: "all_stores",
        markdownContent: `## ä¸ºä»€ä¹ˆçŸ­ä¿¡ä¾ç„¶ä¸å¯æ›¿ä»£ï¼Ÿ\n\nè™½ç„¶å¾®ä¿¡å¾ˆæ™®åŠï¼Œä½†åªæœ‰çŸ­ä¿¡èƒ½ä¿è¯**99.9% çš„å³æ—¶åˆ°è¾¾ç‡**å’Œ**å¼ºæé†’å±æ€§**ã€‚å¯¹äºè€å¹´æ‚£è€…æˆ–ç´§æ€¥é€šçŸ¥ï¼ŒçŸ­ä¿¡ä¾ç„¶æ˜¯ç‹è€…ã€‚\n\n### é»„é‡‘åº”ç”¨åœºæ™¯\n* **é¢„çº¦æˆåŠŸæé†’**ï¼šç»™æ‚£è€…ä¸€é¢—å®šå¿ƒä¸¸ã€‚\n* **æ£€éªŒç»“æœé€šçŸ¥**ï¼šâ€œæ‚¨çš„æŠ¥å‘Šå·²å‡ºï¼Œè¯·ç‚¹å‡»é“¾æ¥æŸ¥çœ‹â€ï¼Œæ–¹ä¾¿æ‚£è€…ã€‚\n* **èŠ‚æ—¥å…³æ€€**ï¼šé‡é˜³èŠ‚ç»™è€å¹´æ‚£è€…å‘ä¸€æ¡ç¥ç¦ï¼Œæˆæœ¬æä½ï¼Œæ¸©æš–äººå¿ƒã€‚`,
        features: ["ä¸‰ç½‘åˆä¸€æ­£è§„é€šé“", "æ”¯æŒè‡ªå®šä¹‰è¯Šæ‰€ç­¾å", "å‘é€çŠ¶æ€å®æ—¶æŸ¥è¯¢", "é•¿çŸ­ä¿¡è‡ªåŠ¨åˆå¹¶"], benefits: ["æå‡å¤è¯Šç‡", "æä½æˆæœ¬è¥é”€", "å¢å¼ºæ‚£è€…ç²˜æ€§"], reviews: [],
    },
    {
        id: "6", title: "é«˜çº§æŠ¥è¡¨åˆ†æ", description: "é™¢é•¿çš„â€œé©¾é©¶èˆ±â€ã€‚å¤šç»´æ•°æ®é€è§†ï¼Œå“ªé‡Œèµšé’±ã€å“ªé‡ŒäºæŸä¸€ç›®äº†ç„¶ï¼Œç”¨æ•°æ®æŒ‡å¯¼ç»è¥å†³ç­–ã€‚",
        price: 699, type: "software", rating: 4.6, reviewsCount: 45, minVersionRequired: "ä¸“ä¸šç‰ˆ",
        isOwned: false, tags: ["æ•°æ®", "ç®¡ç†"], imageColor: "bg-indigo-100", scope: "all_stores",
        markdownContent: `## å‘Šåˆ«â€œæ‹è„‘è¢‹â€åšå†³ç­–\n\nå¾ˆå¤šé™¢é•¿åªçŸ¥é“æ¯ä¸ªæœˆæ”¶äº†å¤šå°‘é’±ï¼Œä½†ä¸çŸ¥é“**å“ªç±»ç—…äººæœ€èµšé’±ï¼Ÿå“ªä¸ªåŒ»ç”Ÿæµå¤±ç‡æœ€é«˜ï¼Ÿ** é«˜çº§æŠ¥è¡¨å¸®æ‚¨åƒåšä½“æ£€ä¸€æ ·å‰–æè¯Šæ‰€ç»è¥çŠ¶å†µã€‚\n\n![æŠ¥è¡¨çœ‹æ¿](placeholder-report)\n\n### æ ¸å¿ƒæ´å¯Ÿ\n* **æ‚£è€…ç”»åƒ**ï¼šæ‚¨çš„ä¸»åŠ›å®¢ç¾¤æ˜¯å‘¨è¾¹çš„è€äººï¼Œè¿˜æ˜¯å†™å­—æ¥¼çš„ç™½é¢†ï¼Ÿ\n* **è½¬åŒ–æ¼æ–—**ï¼šåˆè¯Šåˆ°å¤è¯Šçš„è½¬åŒ–ç‡æ˜¯å¤šå°‘ï¼Ÿå¡åœ¨å“ªä¸ªç¯èŠ‚äº†ï¼Ÿ\n* **è´¢åŠ¡é€è§†**ï¼šè¯å æ¯”ã€è€—ææ¯”æ˜¯å¦åˆç†ï¼Ÿæœ‰æ²¡æœ‰è·‘å†’æ»´æ¼ï¼Ÿ`,
        features: ["æ‹–æ‹½å¼è‡ªå®šä¹‰æŠ¥è¡¨è®¾è®¡", "å…³é”®æŒ‡æ ‡è‡ªåŠ¨è®¢é˜…æ¨é€", "ç§»åŠ¨ç«¯é™¢é•¿é©¾é©¶èˆ±", "åŸå§‹æ•°æ®Excelå¯¼å‡º"], benefits: ["ç§‘å­¦å†³ç­–æ”¯æŒ", "è§£æ”¾ç»Ÿè®¡äººåŠ›", "è´¢åŠ¡é£é™©ç®¡æ§"], reviews: [],
    }
];

// --- COMPONENTS ---

// New: Decoupled Floating Consultant Widget
const ProductConsultantWidget = () => (
    <div className="absolute bottom-24 right-6 w-72 bg-white rounded-2xl shadow-2xl border border-blue-100 z-40 overflow-hidden animate-in slide-in-from-right-10 duration-500 hover:shadow-blue-200/50 transition-shadow">
        {/* Widget Header */}
        <div className="bg-gradient-to-r from-blue-600 to-indigo-600 p-4 flex items-center gap-3">
            <div className="relative">
                <div className="w-10 h-10 rounded-full bg-white/20 border border-white/30 flex items-center justify-center text-white font-bold backdrop-blur-sm">A</div>
                <div className="absolute bottom-0 right-0 w-2.5 h-2.5 bg-green-400 border-2 border-blue-600 rounded-full"></div>
            </div>
            <div className="text-white">
                <div className="text-sm font-bold flex items-center gap-1">äº§å“é¡¾é—® <span className="text-[10px] bg-white/20 px-1.5 py-0.5 rounded font-normal">Online</span></div>
                <div className="text-[10px] opacity-90 mt-0.5">æœ‰é—®é¢˜ï¼Ÿæˆ‘åœ¨çº¿ä¸ºæ‚¨è§£ç­”</div>
            </div>
        </div>
        
        {/* Widget Content */}
        <div className="p-4 bg-white">
             <div className="bg-gray-50 p-3 rounded-lg text-xs text-gray-600 mb-4 border border-gray-100 leading-relaxed">
                ğŸ‘‹ æ‚¨å¥½ï¼æˆ‘æ˜¯è´Ÿè´£è¯¥äº§å“çš„æŠ€æœ¯é¡¾é—®ã€‚å…³äºåŠŸèƒ½ã€æŠ¥ä»·æˆ–éƒ¨ç½²æ–¹æ¡ˆï¼Œéšæ—¶é—®æˆ‘ã€‚
             </div>
             <div className="space-y-2">
                 <button className="w-full flex items-center justify-center gap-2 bg-blue-50 text-blue-600 border border-blue-100 px-3 py-2 rounded-lg text-xs font-bold hover:bg-blue-100 transition-colors" onClick={() => alert("æ­£åœ¨æ‹¨æ‰“ 400-888-9999...")}>
                    <PhoneCall size={14} /> ç”µè¯å’¨è¯¢
                </button>
                <div className="relative group w-full">
                    <button className="w-full flex items-center justify-center gap-2 bg-green-50 text-green-600 border border-green-100 px-3 py-2 rounded-lg text-xs font-bold hover:bg-green-100 transition-colors">
                        <MessageCircle size={14} /> å¾®ä¿¡æ²Ÿé€š
                    </button>
                     {/* Hover QR Overlay */}
                     <div className="absolute bottom-full left-0 w-full mb-2 opacity-0 group-hover:opacity-100 transition-all duration-200 pointer-events-none group-hover:pointer-events-auto transform translate-y-2 group-hover:translate-y-0 z-20">
                        <div className="bg-white p-3 rounded-xl shadow-xl border border-gray-100 text-center mx-auto">
                            <div className="w-full aspect-square bg-gray-100 rounded-lg flex items-center justify-center mb-2">
                                 <QrCode size={48} className="text-gray-400"/>
                            </div>
                            <div className="text-[10px] text-gray-400">æ‰«ç æ·»åŠ å¥½å‹</div>
                        </div>
                     </div>
                </div>
            </div>
        </div>
    </div>
);

const Badge = ({ children, color }: { children: React.ReactNode, color: string }) => (
    <span className={`px-2 py-0.5 rounded text-xs font-medium ${color}`}>{children}</span>
);

const Button = ({ variant = 'primary', className = '', children, onClick, disabled }: any) => {
    const baseStyle = "px-4 py-2 rounded-lg font-medium transition-all duration-200 flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed";
    const variants: any = {
        primary: "bg-blue-600 text-white hover:bg-blue-700 shadow-sm shadow-blue-200",
        secondary: "bg-white text-gray-700 border border-gray-200 hover:bg-gray-50",
        outline: "bg-transparent border border-blue-600 text-blue-600 hover:bg-blue-50",
        ghost: "bg-transparent text-gray-600 hover:bg-gray-100",
        danger: "bg-red-50 text-red-600 border border-red-100 hover:bg-red-100",
        wechat: "bg-[#07C160] text-white hover:bg-[#06ad56] border-none shadow-sm",
        alipay: "bg-[#1677FF] text-white hover:bg-[#1363d6] border-none shadow-sm",
        corporate: "bg-slate-700 text-white hover:bg-slate-800 border-none shadow-sm"
    };
    return (
        <button className={`${baseStyle} ${variants[variant]} ${className}`} onClick={onClick} disabled={disabled}>{children}</button>
    );
};

const Modal = ({ isOpen, onClose, children, title, maxWidth = "max-w-3xl", zIndex = 50 }: any) => {
    if (!isOpen) return null;
    return (
        <div 
            className={`fixed inset-0 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4`} 
            style={{ zIndex }}
            onClick={(e) => { if(e.target === e.currentTarget) onClose(); }} 
        >
            <div className={`bg-white rounded-xl shadow-2xl w-full ${maxWidth} max-h-[90vh] overflow-hidden animate-in fade-in zoom-in-95 duration-200 flex flex-col relative`}>
                <div className="flex justify-between items-center px-6 py-4 border-b border-gray-100 flex-shrink-0 bg-gray-50/50">
                    <h3 className="text-lg font-bold text-gray-900">{title}</h3>
                    <button onClick={onClose} className="text-gray-400 hover:text-gray-600 transition-colors z-50">
                        <X size={20} />
                    </button>
                </div>
                <div className="overflow-y-auto flex-grow scroll-smooth relative">
                    {children}
                </div>
            </div>
        </div>
    );
};

const SimpleMarkdown = ({ content }: { content: string }) => {
    const lines = content.trim().split('\n');
    return (
        <div className="space-y-4 text-gray-600 text-sm leading-relaxed">
        {lines.map((line, idx) => {
            const trimLine = line.trim();
            if (!trimLine) return null;
            if (trimLine.startsWith('## ')) return <h4 key={idx} className="text-gray-900 font-bold text-lg mt-8 mb-3 border-l-4 border-blue-500 pl-3">{trimLine.replace('## ', '')}</h4>;
            if (trimLine.startsWith('### ')) return <h5 key={idx} className="text-gray-800 font-bold text-base mt-6 mb-2">{trimLine.replace('### ', '')}</h5>;
            if (trimLine.startsWith('![')) {
                const altText = trimLine.match(/!\[(.*?)\]/)?.[1] || "Image";
                return (
                    <div key={idx} className="my-4 bg-slate-100 rounded-lg h-48 border-2 border-dashed border-slate-200 flex flex-col items-center justify-center text-slate-400">
                        <ImageIcon size={32} className="mb-2 opacity-50"/>
                        <span className="text-xs font-medium">{altText}</span>
                        <span className="text-[10px] mt-1">(æ­¤å¤„ä¸ºäº§å“å®æ™¯/ç•Œé¢æ¼”ç¤ºå›¾)</span>
                    </div>
                );
            }
            if (trimLine.startsWith('> ')) return <div key={idx} className="pl-4 border-l-4 border-gray-300 italic text-gray-500 my-4 bg-gray-50 p-3 rounded-r">{trimLine.replace('> ', '')}</div>;
            if (trimLine.startsWith('- ')) return <div key={idx} className="flex items-start gap-2 ml-1"><div className="w-1.5 h-1.5 rounded-full bg-blue-500 mt-2 flex-shrink-0"></div><span>{trimLine.replace('- ', '').replace(/\*\*(.*?)\*\*/g, (match, p1) => p1)}</span></div>;
            if (trimLine.startsWith('* ')) return <div key={idx} className="flex items-start gap-2 ml-1"><div className="w-1.5 h-1.5 rounded-full bg-gray-400 mt-2 flex-shrink-0"></div><span>{trimLine.replace('* ', '').replace(/\*\*(.*?)\*\*/g, (match, p1) => p1)}</span></div>;
            const parts = trimLine.split(/(\*\*.*?\*\*)/);
            return <p key={idx}>{parts.map((part, i) => part.startsWith('**') ? <strong key={i} className="text-gray-900 font-bold">{part.slice(2, -2)}</strong> : part)}</p>;
        })}
        </div>
    );
};

// --- APP LOGIC ---

export default function AppStoreDemo() {
    const [activeTab, setActiveTab] = useState('store'); 
    const [balance, setBalance] = useState(USER_PROFILE.balance);
    const [transactions, setTransactions] = useState<any[]>(INITIAL_TRANSACTIONS);

    // Modals
    const [selectedProduct, setSelectedProduct] = useState<any>(null);
    const [showPurchaseModal, setShowPurchaseModal] = useState(false);
    const [showRechargeModal, setShowRechargeModal] = useState(false);
    const [showInvoiceConfigModal, setShowInvoiceConfigModal] = useState(false);
    const [showInvoiceApplyModal, setShowInvoiceApplyModal] = useState<string | null>(null);
    const [showOrderDetailModal, setShowOrderDetailModal] = useState<any>(null);
    
    const [showRenewalModal, setShowRenewalModal] = useState(false);
    const [showUpgradeModal, setShowUpgradeModal] = useState(false);
    const [showWithdrawModal, setShowWithdrawModal] = useState(false);
    
    const [showAuthModal, setShowAuthModal] = useState(false);
    const [viewingGuide, setViewingGuide] = useState<any>(null);
    const [viewingDevice, setViewingDevice] = useState<any>(null);

    const [pendingOrder, setPendingOrder] = useState<any>(null);
    const [paymentMethod, setPaymentMethod] = useState('wechat'); 
    const [invoiceInfo, setInvoiceInfo] = useState(INITIAL_INVOICE_INFO);
    const [rechargeAmount, setRechargeAmount] = useState<number | null>(null);
    const [withdrawAmount, setWithdrawAmount] = useState<number | null>(null);
    const [renewalYears, setRenewalYears] = useState(1);
    
    const PRICING: Record<string, number> = { "åŸºç¡€ç‰ˆ": 1980, "ä¸“ä¸šç‰ˆ": 3600, "æ——èˆ°ç‰ˆ": 9800, "å¤§å®¢æˆ·ç‰ˆ": 0 };

    const checkCompatibility = (requiredVersion: string) => {
        const userLevel = VERSION_LEVELS[USER_PROFILE.currentVersion] || 1;
        const reqLevel = VERSION_LEVELS[requiredVersion] || 1;
        return userLevel >= reqLevel;
    };

    const handlePaymentConfirm = () => {
        if (!pendingOrder) return;
        if (paymentMethod === 'balance' && balance < pendingOrder.price) return;
        if (paymentMethod === 'balance') setBalance(prev => prev - pendingOrder.price);

        const newTransaction = {
            id: `t${Date.now()}`,
            orderNo: `${pendingOrder.type === 'app' ? 'ORD' : pendingOrder.type === 'renewal' ? 'REN' : 'UPG'}${Date.now()}`,
            date: new Date().toLocaleString(),
            item: pendingOrder.title,
            type: 'expense',
            amount: pendingOrder.price,
            originalPrice: pendingOrder.originalPrice || pendingOrder.price,
            discount: pendingOrder.originalPrice ? pendingOrder.originalPrice - pendingOrder.price : 0,
            status: paymentMethod === 'corporate' ? 'pending' : 'success',
            deliveryStatus: paymentMethod === 'corporate' ? 'processing' : 'delivered',
            invoiced: false,
            paymentMethod: getPaymentMethodLabel(paymentMethod),
            snapshot: {
                period: pendingOrder.type === 'renewal' ? `${pendingOrder.payload?.years} å¹´` : 'æ°¸ä¹… / 1å¹´',
                seats: pendingOrder.type === 'upgrade' ? 20 : 1,
                expiryDate: '2025-12-31',
                features: pendingOrder.payload?.features || []
            }
        };

        setTransactions(prev => [newTransaction, ...prev]);
        setShowPurchaseModal(false);
        
        setTimeout(() => {
            let msg = '';
            if (paymentMethod === 'corporate') {
                msg = "ğŸ“ è®¢å•å·²æäº¤ï¼\n\nè¯·å°½å¿«å®Œæˆçº¿ä¸‹æ±‡æ¬¾ï¼Œå¹¶åœ¨ã€å†å²è®¢å•ã€‘ä¸­ä¸Šä¼ å‡­è¯ã€‚";
            } else {
                if (pendingOrder.type === 'renewal') msg = `ğŸ‰ ç»­è´¹æˆåŠŸï¼\n\næœ‰æ•ˆæœŸå·²å»¶é•¿è‡³ ${2025 + (pendingOrder.payload?.years || 1)}-12-31`;
                else if (pendingOrder.type === 'upgrade') msg = `ğŸ‰ å‡çº§æˆåŠŸï¼\n\næ¬¢è¿ä½¿ç”¨${pendingOrder.title.split(' ')[0]}ï¼Œæ–°æƒç›Šå·²ç”Ÿæ•ˆã€‚`;
                else {
                    const isHardware = pendingOrder.payload?.features?.some((f: string) => f.includes('æ‰“å°') || f.includes('ç›’å­') || f.includes('æ£€æµ‹'));
                    msg = isHardware ? `ğŸ‰ æ”¯ä»˜æˆåŠŸï¼\n\nç¡¬ä»¶è®¾å¤‡å°†å°½å¿«å‘è´§ï¼Œè¯·ç•™æ„çŸ­ä¿¡é€šçŸ¥ã€‚` : `ğŸ‰ æ”¯ä»˜æˆåŠŸï¼\n\nè¯·å‰å¾€ã€å·²è´­åŠŸèƒ½ã€‘æŸ¥çœ‹ã€‚`;
                }
            }
            alert(msg);
        }, 500);
        
        if (selectedProduct) setSelectedProduct(null);
        setPendingOrder(null);
    };

    const initiateAppPurchase = (product: any) => {
        setPendingOrder({ type: 'app', title: product.title, price: product.price, originalPrice: product.price, description: product.description, payload: { features: product.features } });
        setPaymentMethod('wechat'); setShowPurchaseModal(true);
    };

    const initiateRenewal = () => {
        const currentPrice = PRICING[USER_PROFILE.currentVersion] || 1980;
        const price = currentPrice * renewalYears * 0.9; 
        setPendingOrder({ type: 'renewal', title: `${USER_PROFILE.currentVersion} - ç»­è´¹ ${renewalYears} å¹´`, price: price, originalPrice: currentPrice * renewalYears, description: `å»¶é•¿å½“å‰ç‰ˆæœ¬æœ‰æ•ˆæœŸ ${renewalYears} å¹´`, payload: { years: renewalYears } });
        setPaymentMethod('wechat'); setShowRenewalModal(false); setShowPurchaseModal(true);
    };

    const initiateUpgrade = (targetVersion: string, price: number) => {
        setPendingOrder({ type: 'upgrade', title: `å‡çº§è‡³${targetVersion}`, price: price, originalPrice: price, description: 'è¡¥å·®ä»·å‡çº§ï¼Œç«‹å³äº«å—æ›´å¤šæƒç›Š', payload: { target: targetVersion } });
        setPaymentMethod('wechat'); setShowUpgradeModal(false); setShowPurchaseModal(true);
    };

    const handleWithdraw = () => {
        if (!withdrawAmount || withdrawAmount > balance) return;
        setBalance(prev => prev - withdrawAmount);
        setTransactions(prev => [{ id: `t${Date.now()}`, orderNo: `WTH${Date.now()}`, date: new Date().toLocaleString(), item: 'ä½™é¢æç°', type: 'withdrawal', amount: withdrawAmount, status: 'pending', deliveryStatus: 'none', invoiced: false, paymentMethod: 'åŸè·¯é€€å›/å¯¹å…¬è´¦æˆ·' }, ...prev]);
        setShowWithdrawModal(false); setWithdrawAmount(null); alert("æç°ç”³è¯·å·²æäº¤ï¼Œé¢„è®¡ 1-3 ä¸ªå·¥ä½œæ—¥åˆ°è´¦ã€‚");
    };

    const getPaymentMethodLabel = (method: string) => {
        switch(method) { case 'wechat': return 'å¾®ä¿¡æ”¯ä»˜'; case 'alipay': return 'æ”¯ä»˜å®'; case 'corporate': return 'å¯¹å…¬è½¬è´¦'; case 'balance': return 'è´¦æˆ·ä½™é¢'; default: return 'æœªçŸ¥'; }
    };

    const handleRecharge = () => {
        if (rechargeAmount) {
            setBalance(prev => prev + rechargeAmount);
            setTransactions(prev => [{ id: `t${Date.now()}`, orderNo: `REC${Date.now()}`, date: new Date().toLocaleString(), item: 'è´¦æˆ·ä½™é¢å……å€¼', type: 'recharge', amount: rechargeAmount, originalPrice: rechargeAmount, discount: 0, status: 'success', deliveryStatus: 'delivered', invoiced: false, paymentMethod: 'å¾®ä¿¡æ”¯ä»˜', snapshot: { period: 'æ°¸ä¹…æœ‰æ•ˆ' } }, ...prev]);
            setShowRechargeModal(false); setRechargeAmount(null); alert("å……å€¼æˆåŠŸï¼");
        }
    };

    const handleApplyInvoice = (transactionId: string) => {
        setTransactions(prev => prev.map(t => t.id === transactionId ? { ...t, invoiced: true } : t));
        setShowInvoiceApplyModal(null); setShowOrderDetailModal(null); alert("å‘ç¥¨ç”³è¯·å·²æäº¤ã€‚");
    };

    // --- Views ---

    const StoreView = () => (
        <div className="space-y-8 animate-in fade-in duration-300">
            <div className="bg-white rounded-xl border border-blue-100 shadow-sm relative overflow-hidden">
                <div className="absolute top-0 right-0 w-1/3 h-full bg-gradient-to-l from-blue-50 to-transparent pointer-events-none"></div>
                <div className="relative z-10 flex flex-col md:flex-row items-center justify-between p-6 gap-6">
                    <div className="flex items-center gap-5 w-full md:w-auto">
                    <div className="w-16 h-16 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-2xl flex items-center justify-center text-white shadow-blue-200 shadow-lg flex-shrink-0"><Crown size={32} /></div>
                    <div><div className="flex items-center gap-3 mb-1"><h2 className="text-xl font-bold text-gray-900">{USER_PROFILE.currentVersion}</h2><Badge color="bg-green-100 text-green-700 border border-green-200">æ­£å¸¸ä½¿ç”¨ä¸­</Badge></div><p className="text-gray-500 text-sm">ä¸ªä½“è¯Šæ‰€/åŒ»é¦†é¦–é€‰ Â· 2GB å­˜å‚¨</p></div>
                    </div>
                    <div className="hidden lg:flex items-center gap-10 border-l border-r border-gray-100 px-10 h-12">
                        <div className="flex items-center gap-3"><div className="p-2 bg-blue-50 rounded-lg text-blue-600"><Layers size={18}/></div><div><div className="text-gray-900 font-bold leading-none">3</div><div className="text-gray-400 text-xs mt-1">å·²å®‰è£…åŠŸèƒ½</div></div></div>
                        <div className="flex items-center gap-3"><div className="p-2 bg-purple-50 rounded-lg text-purple-600"><Users size={18}/></div><div><div className="text-gray-900 font-bold leading-none">2/5</div><div className="text-gray-400 text-xs mt-1">åŒ»ç”Ÿè´¦å·</div></div></div>
                        <div className="flex items-center gap-3"><div className="p-2 bg-amber-50 rounded-lg text-amber-600"><Database size={18}/></div><div><div className="text-gray-900 font-bold leading-none">1.2GB</div><div className="text-gray-400 text-xs mt-1">å‰©ä½™ç©ºé—´</div></div></div>
                    </div>
                    <div className="flex items-center gap-3 w-full md:w-auto">
                        <Button variant="outline" className="border-gray-200 text-gray-600 hover:bg-gray-50 bg-white" onClick={() => setShowRenewalModal(true)}>ç»­è´¹</Button>
                        <Button className="bg-gradient-to-r from-amber-500 to-orange-500 hover:from-amber-600 hover:to-orange-600 border-none text-white shadow-orange-100 flex-1 md:flex-none" onClick={() => setShowUpgradeModal(true)}><span className="flex items-center gap-1">å‡çº§ (æ›´å¤šè´¦å·) <ChevronRight size={16} /></span></Button>
                    </div>
                </div>
            </div>
            <div>
                <div className="flex items-center justify-between mb-4"><h3 className="text-lg font-bold text-gray-800">ç²¾é€‰åº”ç”¨</h3><button className="text-sm text-blue-600 hover:underline">æŸ¥çœ‹å…¨éƒ¨</button></div>
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    {PRODUCTS.map(p => (
                        <div key={p.id} className="group bg-white rounded-xl border border-gray-200 p-5 hover:shadow-lg hover:border-blue-300 transition-all duration-300 cursor-pointer flex flex-col h-full relative overflow-hidden" onClick={() => setSelectedProduct(p)}>
                            <div className="flex items-start justify-between mb-4 relative z-10">
                                <div className={`w-12 h-12 rounded-xl ${p.imageColor} flex items-center justify-center text-gray-700 shadow-sm`}>{p.type === 'software' ? <Smartphone size={32} /> : <Activity size={32} />}</div>
                                <div className="flex flex-col items-end gap-1">{p.isOwned && <Badge color="bg-green-100 text-green-700">å·²æ‹¥æœ‰</Badge>}<span className={`text-[10px] px-1.5 py-0.5 rounded border ${p.scope === 'all_stores' ? 'bg-blue-50 text-blue-700 border-blue-100' : 'bg-gray-50 text-gray-500 border-gray-100'}`}>{p.scope === 'all_stores' ? 'å…¨è¿é”é€šç”¨' : 'å•åº—æˆæƒ'}</span></div>
                            </div>
                            <h3 className="font-bold text-gray-900 text-lg mb-2 group-hover:text-blue-600 transition-colors">{p.title}</h3>
                            <p className="text-sm text-gray-500 mb-4 line-clamp-2 leading-relaxed flex-grow">{p.description}</p>
                            <div className="mt-auto pt-4 border-t border-gray-100 flex items-end justify-between">
                                <div><div className="font-bold text-lg text-gray-900 leading-none">{p.price > 0 ? `Â¥${p.price}` : 'å…è´¹'}</div>{p.trialDays && !p.isOwned && (<div className="mt-1.5"><span className="text-[10px] font-medium text-purple-700 bg-purple-50 px-1.5 py-0.5 rounded border border-purple-100">å…è´¹è¯•ç”¨ {p.trialDays} å¤©</span></div>)}</div>
                                <span className="text-blue-600 text-xs flex items-center gap-1 mb-1">è¯¦æƒ… <ArrowRight size={12} /></span>
                            </div>
                        </div>
                    ))}
                </div>
            </div>
        </div>
    );

    const HistoryOrderView = () => (
        <div className="w-full space-y-6 animate-in fade-in duration-300">
            <div className="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-white p-6 rounded-xl border border-gray-200 shadow-sm">
                <div><h2 className="text-lg font-bold text-gray-900">å†å²è®¢å•</h2><p className="text-gray-500 text-sm mt-1">æŸ¥çœ‹è´­ä¹°è®°å½•ã€å¼€å…·å‘ç¥¨</p></div>
                <div className="flex gap-3">
                    <Button variant="secondary" onClick={() => setShowWithdrawModal(true)} className="text-red-600 hover:text-red-700 hover:bg-red-50 border-red-100"><LogOut size={16}/> æç°</Button>
                    <Button variant="secondary" onClick={() => setShowInvoiceConfigModal(true)}><Settings size={16}/> å‘ç¥¨æŠ¬å¤´</Button>
                </div>
            </div>
            <div className="bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden">
                <div className="overflow-x-auto">
                <table className="w-full text-left">
                    <thead className="bg-white text-gray-500 text-xs uppercase border-b border-gray-100">
                        <tr>
                            <th className="px-6 py-3 font-medium whitespace-nowrap">æ—¶é—´</th>
                            <th className="px-6 py-3 font-medium whitespace-nowrap">é¡¹ç›®</th>
                            <th className="px-6 py-3 font-medium whitespace-nowrap">é‡‘é¢</th>
                            <th className="px-6 py-3 font-medium text-center whitespace-nowrap">çŠ¶æ€</th>
                            <th className="px-6 py-3 font-medium text-center whitespace-nowrap">å‘ç¥¨</th>
                            <th className="px-6 py-3 font-medium text-right whitespace-nowrap">è¯¦æƒ…</th>
                        </tr>
                    </thead>
                    <tbody className="divide-y divide-gray-100 text-sm bg-white">
                        {transactions.map(t => (
                            <tr key={t.id} className="hover:bg-gray-50 transition-colors cursor-pointer" onClick={() => setShowOrderDetailModal(t)}>
                                <td className="px-6 py-4 text-gray-500 whitespace-nowrap"><div className="font-medium text-gray-900">{t.date}</div><div className="text-xs text-gray-400 mt-0.5">{t.orderNo}</div></td>
                                <td className="px-6 py-4"><div className="font-medium text-gray-900">{t.item}</div><div className="text-xs text-gray-400 mt-0.5">{t.type === 'recharge' && 'è´¦æˆ·å……å€¼'}{t.type === 'expense' && 'æœåŠ¡é‡‡è´­'}{t.type === 'withdrawal' && 'ä½™é¢æç°'}</div></td>
                                <td className={`px-6 py-4 font-medium font-mono ${t.type === 'recharge' ? 'text-green-600' : t.type === 'withdrawal' ? 'text-gray-500' : 'text-gray-900'}`}>{t.type === 'recharge' ? '+' : '-'} Â¥{Math.abs(t.amount).toFixed(2)}</td>
                                <td className="px-6 py-4 text-center">{t.status === 'success' ? <span className="text-xs bg-green-50 text-green-700 px-2 py-0.5 rounded-full border border-green-100">æˆåŠŸ</span> : <span className="text-xs bg-yellow-50 text-yellow-700 px-2 py-0.5 rounded-full border border-yellow-100">å¾…å¤„ç†</span>}</td>
                                <td className="px-6 py-4 text-center">{t.type === 'withdrawal' ? <span className="text-xs text-gray-300">-</span> : (t.invoiced ? <span className="text-xs text-gray-400 flex items-center justify-center gap-1"><CheckCircle2 size={12}/> å·²å¼€</span> : <span className="text-xs text-orange-500 bg-orange-50 px-2 py-0.5 rounded-full">æœªå¼€ç¥¨</span>)}</td>
                                <td className="px-6 py-4 text-right"><ChevronRight size={16} className="text-gray-400 inline-block" /></td>
                            </tr>
                        ))}
                    </tbody>
                </table>
                </div>
            </div>
        </div>
    );

    const OrdersView = () => {
        const ownedProducts = PRODUCTS.filter(p => p.isOwned);
        return (
            <div className="space-y-6 animate-in fade-in duration-300">
                <div className="flex justify-between items-center bg-white p-4 rounded-xl border border-gray-200 shadow-sm">
                    <div><h2 className="text-lg font-bold text-gray-900">å·²è´­æœåŠ¡ç®¡ç† ({ownedProducts.length})</h2><p className="text-sm text-gray-500 mt-1">ç®¡ç†æ‚¨çš„åº”ç”¨æˆæƒã€åˆ†é…é—¨åº—åŠç»­è´¹</p></div>
                    <Button variant="outline" className="text-xs" onClick={() => setShowAuthModal(true)}><Settings size={14}/> å„é—¨åº—ä½¿ç”¨æƒ…å†µ</Button>
                </div>
                <div className="grid grid-cols-1 gap-4">
                    {ownedProducts.map(p => (
                        <div key={p.id} className="bg-white rounded-xl border border-gray-200 p-6 shadow-sm flex flex-col md:flex-row gap-6 items-start md:items-center relative overflow-hidden group hover:border-blue-300 transition-colors">
                            <div className={`absolute left-0 top-0 bottom-0 w-1 ${p.purchaseInfo?.status === 'active' ? 'bg-green-500' : 'bg-orange-500'}`}></div>
                            <div className="flex items-center gap-4 min-w-[240px]">
                                <div className={`w-16 h-16 rounded-xl ${p.imageColor} flex items-center justify-center text-gray-700 shadow-sm`}>{p.type === 'software' ? <Smartphone size={32} /> : <Activity size={32} />}</div>
                                <div>
                                    <h3 className="font-bold text-lg text-gray-900">{p.title}</h3>
                                    <div className="flex items-center gap-2 mt-1"><span className={`text-xs px-2 py-0.5 rounded-full flex items-center gap-1 ${p.purchaseInfo?.status === 'active' ? 'bg-green-50 text-green-700' : 'bg-orange-50 text-orange-700'}`}><span className={`w-1.5 h-1.5 rounded-full ${p.purchaseInfo?.status === 'active' ? 'bg-green-500' : 'bg-orange-500'}`}></span>{p.purchaseInfo?.status === 'active' ? 'ç”Ÿæ•ˆä¸­' : 'å³å°†åˆ°æœŸ'}</span><span className="text-xs text-gray-400">{p.type === 'hardware' ? 'ç¡¬ä»¶è®¾å¤‡' : 'SaaS æ’ä»¶'}</span></div>
                                </div>
                            </div>
                            <div className="flex-1 grid grid-cols-2 lg:grid-cols-3 gap-y-4 gap-x-8 text-sm w-full">
                                <div><div className="text-gray-400 mb-1 text-xs">æœ‰æ•ˆæœŸè‡³</div><div className="font-medium text-gray-900 flex items-center gap-1"><Calendar size={14} className="text-gray-400"/>{p.purchaseInfo?.expiryDate}</div></div>
                                <div><div className="text-gray-400 mb-1 text-xs">æˆæƒèŒƒå›´</div><div className="font-medium text-gray-900 flex items-center gap-1">{p.scope === 'all_stores' ? <span className="bg-blue-50 text-blue-700 px-2 py-0.5 rounded text-xs border border-blue-100 flex items-center gap-1"><Globe size={12}/> å…¨è¿é”é€šç”¨</span> : <span className="bg-gray-100 text-gray-600 px-2 py-0.5 rounded text-xs border border-gray-200 flex items-center gap-1"><Store size={12}/> å•åº—æˆæƒ</span>}</div></div>
                                {p.scope === 'per_store' && (<div className="col-span-2 lg:col-span-1"><div className="text-gray-400 mb-1 text-xs">å·²åˆ†é…é—¨åº—</div><div className="flex flex-wrap gap-1">{p.purchaseInfo?.authorizedStores?.map((store: string) => (<span key={store} className="text-xs bg-gray-50 border border-gray-200 px-1.5 py-0.5 rounded text-gray-600" title={store}>{store.length > 6 ? store.substring(0, 6) + '...' : store}</span>))}<button className="text-xs text-blue-600 hover:bg-blue-50 px-1 rounded"><Plus size={12}/></button></div></div>)}
                                {p.purchaseInfo?.usage && (<div><div className="text-gray-400 mb-1 text-xs">å½“å‰ç”¨é‡/çŠ¶æ€</div><div className="font-medium text-gray-900">{p.purchaseInfo.usage}</div></div>)}
                            </div>
                            <div className="flex items-center gap-3 w-full md:w-auto justify-end mt-4 md:mt-0 border-t md:border-t-0 border-gray-100 pt-4 md:pt-0">
                                {p.type === 'software' ? <Button variant="outline" className="text-xs h-8 px-3" onClick={() => setViewingGuide(p)}>ä½¿ç”¨æŒ‡å—</Button> : <Button variant="outline" className="text-xs h-8 px-3" onClick={() => setViewingDevice(p)}>è®¾å¤‡çŠ¶æ€</Button>}
                                {p.purchaseInfo?.status !== 'active' ? <Button className="text-xs h-8 px-4 bg-orange-500 hover:bg-orange-600">ç«‹å³ç»­è´¹</Button> : <Button className="text-xs h-8 px-4 shadow-blue-100" onClick={() => alert(`æ­£åœ¨è·³è½¬è‡³ ã€${p.title}ã€‘ é…ç½®åå°...`)}>{p.type === 'software' ? 'å‰å¾€è®¾ç½®' : 'æŸ¥çœ‹è¯¦æƒ…'}</Button>}
                            </div>
                        </div>
                    ))}
                </div>
            </div>
        );
    };

    return (
        <div className="bg-slate-50 text-gray-800 font-sans min-h-screen">
            <div className="bg-white border-b border-gray-200 sticky top-0 z-30 px-6 h-16 flex items-center justify-between shadow-sm">
                <div className="flex items-center h-full gap-8">
                    <div className="flex items-center gap-2 text-gray-900 font-bold text-lg mr-4">
                        <div className="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center text-white"><Layout size={18} /></div>
                        åº”ç”¨ä¸­å¿ƒ
                    </div>
                    <nav className="hidden md:flex h-full">
                        <button onClick={() => setActiveTab('store')} className={`px-4 h-full border-b-2 text-sm font-medium transition-colors flex items-center gap-2 ${activeTab === 'store' ? 'border-blue-600 text-blue-600 bg-blue-50/50' : 'border-transparent text-gray-600 hover:text-gray-900 hover:bg-gray-50'}`}><ShoppingBag size={16} /> é€‰è´­ä¸­å¿ƒ</button>
                        <button onClick={() => setActiveTab('orders')} className={`px-4 h-full border-b-2 text-sm font-medium transition-colors flex items-center gap-2 ${activeTab === 'orders' ? 'border-blue-600 text-blue-600 bg-blue-50/50' : 'border-transparent text-gray-600 hover:text-gray-900 hover:bg-gray-50'}`}><Package size={16} /> å·²è´­åŠŸèƒ½</button>
                        <button onClick={() => setActiveTab('wallet')} className={`px-4 h-full border-b-2 text-sm font-medium transition-colors flex items-center gap-2 ${activeTab === 'wallet' ? 'border-blue-600 text-blue-600 bg-blue-50/50' : 'border-transparent text-gray-600 hover:text-gray-900 hover:bg-gray-50'}`}><CreditCard size={16} /> å†å²è®¢å•</button>
                    </nav>
                </div>
                <div className="flex items-center gap-4">
                    <div className="flex items-center gap-2 cursor-pointer hover:opacity-80 transition-opacity" onClick={() => setActiveTab('wallet')}>
                        <div className="text-right">
                            <div className="text-[10px] text-gray-400 uppercase font-bold tracking-wider">è´¦æˆ·ä½™é¢</div>
                            <div className="text-sm font-bold text-gray-900 font-mono">Â¥{balance.toFixed(2)}</div>
                        </div>
                        <div className="w-8 h-8 bg-blue-50 rounded-full flex items-center justify-center text-blue-600"><Wallet size={16} /></div>
                    </div>
                </div>
            </div>

            <main className="p-6">
                {activeTab === 'store' && <StoreView />}
                {activeTab === 'wallet' && <HistoryOrderView />}
                {activeTab === 'orders' && <OrdersView />}
            </main>

            {/* --- MODALS --- */}
            <Modal isOpen={showPurchaseModal} onClose={() => setShowPurchaseModal(false)} title="æ”¶é“¶å°" maxWidth="max-w-4xl">
                <div className="flex flex-col md:flex-row h-[500px]">
                    <div className="w-full md:w-1/3 bg-gray-50 border-r border-gray-100 p-4 space-y-2">
                        <div className="text-xs font-bold text-gray-400 uppercase tracking-wider mb-2 px-2">é€‰æ‹©æ”¯ä»˜æ–¹å¼</div>
                        <button onClick={() => setPaymentMethod('wechat')} className={`w-full flex items-center gap-3 p-3 rounded-lg text-left transition-all ${paymentMethod === 'wechat' ? 'bg-white shadow-sm ring-1 ring-green-500' : 'hover:bg-gray-100 text-gray-600'}`}><Smartphone size={20} className="text-[#07C160]" /><span className={`font-medium ${paymentMethod === 'wechat' ? 'text-gray-900' : ''}`}>å¾®ä¿¡æ”¯ä»˜</span></button>
                        <button onClick={() => setPaymentMethod('alipay')} className={`w-full flex items-center gap-3 p-3 rounded-lg text-left transition-all ${paymentMethod === 'alipay' ? 'bg-white shadow-sm ring-1 ring-blue-500' : 'hover:bg-gray-100 text-gray-600'}`}><QrCode size={20} className="text-[#1677FF]" /><span className={`font-medium ${paymentMethod === 'alipay' ? 'text-gray-900' : ''}`}>æ”¯ä»˜å®</span></button>
                        <button onClick={() => setPaymentMethod('corporate')} className={`w-full flex items-center gap-3 p-3 rounded-lg text-left transition-all ${paymentMethod === 'corporate' ? 'bg-white shadow-sm ring-1 ring-slate-500' : 'hover:bg-gray-100 text-gray-600'}`}><Building2 size={20} className="text-slate-600" /><span className={`font-medium ${paymentMethod === 'corporate' ? 'text-gray-900' : ''}`}>å¯¹å…¬è½¬è´¦</span></button>
                        <div className="my-4 border-t border-gray-200"></div>
                        <button onClick={() => setPaymentMethod('balance')} className={`w-full flex items-center gap-3 p-3 rounded-lg text-left transition-all ${paymentMethod === 'balance' ? 'bg-white shadow-sm ring-1 ring-orange-500' : 'hover:bg-gray-100 text-gray-600'}`}><Wallet size={20} className="text-orange-500" /><div className="flex-1"><div className={`font-medium ${paymentMethod === 'balance' ? 'text-gray-900' : ''}`}>è´¦æˆ·ä½™é¢</div><div className="text-xs text-gray-400">å¯ç”¨: Â¥{balance.toFixed(2)}</div></div></button>
                    </div>
                    <div className="flex-1 p-8 flex flex-col items-center justify-center relative">
                        <div className="absolute top-6 right-6 text-right">
                            <div className="text-sm text-gray-500">åº”ä»˜é‡‘é¢</div>
                            <div className="text-3xl font-bold text-gray-900">Â¥ {pendingOrder?.price.toFixed(2)}</div>
                            {pendingOrder?.title && <div className="text-xs text-gray-400 mt-1 bg-gray-50 px-2 py-1 rounded inline-block">{pendingOrder.title}</div>}
                        </div>
                        {(paymentMethod === 'wechat' || paymentMethod === 'alipay') && (
                            <div className="text-center animate-in fade-in zoom-in-95 duration-300">
                                <div className={`w-48 h-48 mx-auto border-2 rounded-xl flex items-center justify-center mb-4 ${paymentMethod === 'wechat' ? 'border-green-100 bg-green-50' : 'border-blue-100 bg-blue-50'}`}><QrCode size={80} className={`opacity-20 ${paymentMethod === 'wechat' ? 'text-green-600' : 'text-blue-600'}`} /></div>
                                <p className="text-gray-500 text-sm mb-6">è¯·ä½¿ç”¨{paymentMethod === 'wechat' ? 'å¾®ä¿¡' : 'æ”¯ä»˜å®'}æ‰«ä¸€æ‰«</p>
                                <Button className={`w-48 ${paymentMethod === 'wechat' ? 'bg-[#07C160] hover:bg-[#06ad56]' : 'bg-[#1677FF] hover:bg-[#1363d6]'}`} onClick={handlePaymentConfirm}>æˆ‘å·²å®Œæˆæ”¯ä»˜</Button>
                            </div>
                        )}
                        {paymentMethod === 'corporate' && (
                            <div className="w-full max-w-md animate-in fade-in slide-in-from-right-4 duration-300">
                                <div className="bg-slate-50 border border-slate-100 rounded-lg p-5 mb-6 text-sm space-y-3">
                                    <div className="flex justify-between"><span className="text-gray-500">æˆ·å</span><span className="font-bold text-gray-900 select-all">æ­å·åŒ»ç–—ç§‘æŠ€æœ‰é™å…¬å¸</span></div>
                                    <div className="flex justify-between"><span className="text-gray-500">è´¦å·</span><span className="font-bold text-gray-900 select-all">3300 1616 3350 5250 1234</span></div>
                                    <div className="flex justify-between"><span className="text-gray-500">å¼€æˆ·è¡Œ</span><span className="font-bold text-gray-900">ä¸­å›½å»ºè®¾é“¶è¡Œæ­å·æ–‡äºŒè·¯æ”¯è¡Œ</span></div>
                                </div>
                                <Button variant="corporate" className="w-full" onClick={handlePaymentConfirm}><Upload size={18}/> æˆ‘å·²è½¬è´¦ï¼Œä¸‹ä¸€æ­¥ä¸Šä¼ å‡­è¯</Button>
                            </div>
                        )}
                        {paymentMethod === 'balance' && (
                            <div className="w-full max-w-sm text-center animate-in fade-in zoom-in-95 duration-300">
                                {balance >= (pendingOrder?.price || 0) ? (
                                    <>
                                        <div className="bg-green-50 text-green-700 p-4 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4"><CheckCircle2 size={32} /></div>
                                        <h3 className="text-xl font-bold text-gray-900 mb-2">ä½™é¢å……è¶³</h3>
                                        <div className="bg-gray-50 rounded-lg p-4 mb-6 text-sm">
                                            <div className="flex justify-between mb-2"><span className="text-gray-500">å½“å‰ä½™é¢</span><span className="text-gray-900">Â¥ {balance.toFixed(2)}</span></div>
                                            <div className="flex justify-between mb-2"><span className="text-gray-500">æ‰£é™¤é‡‘é¢</span><span className="text-red-600 font-bold">- Â¥ {pendingOrder?.price.toFixed(2)}</span></div>
                                            <div className="border-t border-gray-200 pt-2 flex justify-between"><span className="text-gray-500">æ”¯ä»˜åå‰©ä½™</span><span className="text-green-600 font-bold">Â¥ {(balance - (pendingOrder?.price || 0)).toFixed(2)}</span></div>
                                        </div>
                                        <Button className="w-full bg-orange-500 hover:bg-orange-600" onClick={handlePaymentConfirm}>ç¡®è®¤æ‰£æ¬¾æ”¯ä»˜</Button>
                                    </>
                                ) : (
                                    <>
                                        <div className="bg-red-50 text-red-600 p-4 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4"><X size={32} /></div>
                                        <h3 className="text-xl font-bold text-gray-900 mb-2">ä½™é¢ä¸è¶³</h3>
                                        <div className="flex gap-3 mt-6"><Button variant="secondary" className="flex-1" onClick={() => setShowPurchaseModal(false)}>å–æ¶ˆ</Button><Button className="flex-1" onClick={() => { setShowPurchaseModal(false); setShowRechargeModal(true); }}>å»å……å€¼</Button></div>
                                    </>
                                )}
                            </div>
                        )}
                    </div>
                </div>
            </Modal>

            {/* Renewal Modal */}
            <Modal isOpen={showRenewalModal} onClose={() => setShowRenewalModal(false)} title="ç‰ˆæœ¬ç»­è´¹" maxWidth="max-w-md">
                <div className="p-6">
                    <div className="flex justify-between items-center bg-blue-50 p-4 rounded-lg mb-6 border border-blue-100">
                        <div className="flex items-center gap-3"><div className="w-10 h-10 bg-blue-100 text-blue-600 rounded-lg flex items-center justify-center"><Crown size={20}/></div><div><div className="font-bold text-gray-900">{USER_PROFILE.currentVersion}</div><div className="text-xs text-gray-500">å½“å‰æœ‰æ•ˆæœŸè‡³ 2025-12-31</div></div></div>
                    </div>
                    <div className="space-y-3 mb-6">
                        {[1, 2, 3].map(year => (
                            <div key={year} onClick={() => setRenewalYears(year)} className={`cursor-pointer p-4 border rounded-xl flex justify-between items-center transition-all ${renewalYears === year ? 'border-blue-600 bg-blue-50 ring-1 ring-blue-600' : 'border-gray-200 hover:border-blue-300'}`}>
                                <div><span className="font-bold text-gray-900">ç»­è´¹ {year} å¹´</span>{year > 1 && <span className="ml-2 text-xs text-red-500 bg-red-50 px-1.5 py-0.5 rounded">çœ Â¥{1980 * year * 0.1}</span>}</div>
                                <div className="text-lg font-bold text-gray-900">Â¥ {1980 * year * (year > 1 ? 0.9 : 1)}</div>
                            </div>
                        ))}
                    </div>
                    <Button className="w-full h-12 text-lg" onClick={initiateRenewal}>ç¡®è®¤æ”¯ä»˜ Â¥ {1980 * renewalYears * (renewalYears > 1 ? 0.9 : 1)}</Button>
                </div>
            </Modal>

            {/* Upgrade Modal */}
            <Modal isOpen={showUpgradeModal} onClose={() => setShowUpgradeModal(false)} title="å‡çº§ç‰ˆæœ¬" maxWidth="max-w-6xl">
                    <div className="p-8">
                    <div className="text-center mb-10">
                        <h2 className="text-2xl font-bold text-gray-900 mb-2">é€‰æ‹©é€‚åˆæ‚¨çš„ç‰ˆæœ¬</h2>
                        <p className="text-gray-500">å½“å‰ç‰ˆæœ¬ï¼š<span className="font-bold text-blue-600">{USER_PROFILE.currentVersion}</span>ï¼Œè¡¥å·®ä»·å‡çº§å¯ç«‹å³ç”Ÿæ•ˆ</p>
                    </div>
                    <div className="grid grid-cols-3 gap-6">
                        {/* Pro */}
                        <div className="border border-gray-200 rounded-2xl p-6 hover:shadow-lg transition-all relative">
                            <div className="text-lg font-bold text-gray-900 mb-2">ä¸“ä¸šç‰ˆ</div>
                            <div className="text-3xl font-bold text-blue-600 mb-4">Â¥ 3600 <span className="text-sm font-normal text-gray-500">/å¹´</span></div>
                            <p className="text-sm text-gray-500 mb-6 h-10">é€‚ç”¨äºå¤§ä¸­å‹è¿é”è¯Šæ‰€ï¼Œæ”¯æŒæ›´å¤šè´¦å·ä¸å¾®è¯Šæ‰€åŠŸèƒ½ã€‚</p>
                            <Button className="w-full" onClick={() => initiateUpgrade("ä¸“ä¸šç‰ˆ", 1620)}>å‡çº§ (è¡¥å·®ä»· Â¥1620)</Button>
                        </div>
                        {/* Flagship */}
                        <div className="border-2 border-amber-400 rounded-2xl p-6 shadow-xl relative transform scale-105 bg-white z-10">
                            <div className="text-lg font-bold text-gray-900 mb-2 flex items-center gap-2">æ——èˆ°ç‰ˆ <Crown size={18} className="text-amber-500 fill-current"/></div>
                            <div className="text-3xl font-bold text-amber-500 mb-4">Â¥ 9800 <span className="text-sm font-normal text-gray-500">/å¹´</span></div>
                            <p className="text-sm text-gray-500 mb-6 h-10">å…¨æ–¹ä½è§£å†³æ–¹æ¡ˆï¼Œå« LIS ç³»ç»Ÿä¸ OpenAPI å¯¹æ¥èƒ½åŠ›ã€‚</p>
                            <Button className="w-full bg-gradient-to-r from-amber-500 to-orange-500 border-none hover:from-amber-600 hover:to-orange-600" onClick={() => initiateUpgrade("æ——èˆ°ç‰ˆ", 7820)}>å‡çº§ (è¡¥å·®ä»· Â¥7820)</Button>
                        </div>
                        {/* Enterprise */}
                        <div className="border border-gray-200 rounded-2xl p-6 hover:shadow-lg transition-all bg-gray-50">
                            <div className="text-lg font-bold text-gray-900 mb-2">å¤§å®¢æˆ·ç‰ˆ</div>
                            <div className="text-3xl font-bold text-gray-900 mb-4">é¢è®®</div>
                            <p className="text-sm text-gray-500 mb-6 h-10">é’ˆå¯¹æœ‰æ·±åº¦å®šåˆ¶éœ€æ±‚çš„é›†å›¢å®¢æˆ·ï¼Œæä¾›ç§æœ‰åŒ–éƒ¨ç½²ã€‚</p>
                            <Button variant="outline" className="w-full">è”ç³»å®¢æˆ·ç»ç†</Button>
                        </div>
                    </div>
                </div>
            </Modal>

            {/* Product Detail Modal (Fixed Layout) */}
            {selectedProduct && !showPurchaseModal && (
                <Modal isOpen={!!selectedProduct} onClose={() => setSelectedProduct(null)} title={selectedProduct?.title} maxWidth="max-w-5xl">
                    <div className="flex flex-col h-full relative">
                        {/* Split View Container */}
                        <div className="flex-1 overflow-hidden flex flex-col lg:flex-row">
                            
                            {/* Left: Main Content (Scrollable) */}
                            <div className="flex-1 overflow-y-auto pb-16 lg:pb-6 bg-white"> 
                                <div className="p-8 pb-6 flex gap-6 border-b border-gray-100 bg-white">
                                    <div className={`w-24 h-24 rounded-2xl flex-shrink-0 ${selectedProduct.imageColor} flex items-center justify-center shadow-inner`}>
                                        <ImageIcon size={40} className="text-gray-700"/>
                                    </div>
                                    <div className="flex-1">
                                        <h2 className="text-2xl font-bold text-gray-900 mb-2">{selectedProduct.title}</h2>
                                        <div className="flex items-center gap-2 text-sm text-gray-500 mb-3">
                                            <span className="flex items-center gap-1 text-orange-500 font-medium"><Star size={14} className="fill-current"/> {selectedProduct.rating}</span>
                                        </div>
                                        <p className="text-gray-600 leading-relaxed text-sm mt-1">{selectedProduct.description}</p>
                                    </div>
                                </div>
                                <div className="p-8 space-y-12">
                                    <section><div className="bg-slate-50 p-6 rounded-xl border border-slate-100"><SimpleMarkdown content={selectedProduct.markdownContent} /></div></section>
                                    <section>
                                        <h4 className="font-bold text-gray-900 text-lg flex items-center gap-2 mb-4"><Zap size={18} className="text-amber-500"/> åŠŸèƒ½æ¸…å•</h4>
                                        <ul className="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-2">{selectedProduct.features.map((f: string, i: number) => <li key={i} className="text-sm text-gray-600 list-disc list-inside">{f}</li>)}</ul>
                                    </section>
                                    <section>
                                        <div className="flex items-center justify-between mb-6">
                                            <h4 className="font-bold text-gray-900 text-lg flex items-center gap-2">ç”¨æˆ·è¯„ä»· ({selectedProduct.reviews.length})</h4>
                                        </div>
                                        <div className="space-y-6">
                                            {selectedProduct.reviews.map((review: any) => (
                                                <div key={review.id} className="flex gap-4 border-b border-gray-100 pb-6 last:border-0">
                                                    <div className={`w-10 h-10 rounded-full ${review.avatarColor} flex items-center justify-center text-white font-bold text-sm flex-shrink-0`}>{review.user.charAt(0)}</div>
                                                    <div className="flex-1">
                                                        <div className="flex justify-between items-center mb-1">
                                                            <div className="flex items-center gap-2"><span className="font-bold text-gray-900 text-sm">{review.user}</span><span className="text-xs bg-gray-100 px-1.5 rounded text-gray-500">{review.role}</span></div>
                                                            <div className="text-xs text-gray-400">{review.date}</div>
                                                        </div>
                                                        <div className="flex text-orange-400 mb-2">{[...Array(5)].map((_, i) => <Star key={i} size={12} className={i < review.rating ? "fill-current" : "text-gray-200"}/>)}</div>
                                                        <p className="text-gray-600 text-sm leading-relaxed mb-2">{review.content}</p>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </section>
                                </div>
                            </div>

                            {/* Right: Sidebar (Fixed width) */}
                            <div className="w-full lg:w-80 bg-gray-50 border-l border-gray-100 p-6 overflow-y-auto z-10">
                                <div className="sticky top-0 space-y-6">
                                    <div className="bg-white p-4 rounded-xl border border-gray-200 shadow-sm">
                                        <div className="text-xs font-bold text-gray-400 uppercase tracking-wider mb-3">ç³»ç»Ÿè¦æ±‚</div>
                                        <div className="flex items-center gap-3 mb-2">
                                            <div className="w-8 h-8 rounded-lg bg-blue-50 text-blue-600 flex items-center justify-center">
                                                <Layers size={18}/>
                                            </div>
                                            <div>
                                                <div className="text-xs text-gray-500">æœ€ä½ç‰ˆæœ¬è¦æ±‚</div>
                                                <div className="font-bold text-gray-900">{selectedProduct.minVersionRequired}</div>
                                            </div>
                                        </div>
                                        <div className="text-xs pt-2 border-t border-gray-100 mt-2">
                                            {!checkCompatibility(selectedProduct.minVersionRequired) ? 
                                                <span className="text-red-600 flex items-center gap-1"><AlertCircle size={12}/> å½“å‰ç‰ˆæœ¬ä¸å…¼å®¹</span> : 
                                                <span className="text-green-600 flex items-center gap-1"><CheckCircle2 size={12}/> å½“å‰ç‰ˆæœ¬é€‚ç”¨</span>
                                            }
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* Footer */}
                        <div className="p-6 border-t border-gray-100 bg-white sticky bottom-0 z-50 flex justify-between items-center shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)]">
                            <div className="text-sm flex items-center gap-2">
                                <span className="text-gray-500">ä»·æ ¼ï¼š</span>
                                <span className="text-xl font-bold text-blue-600">{selectedProduct.price > 0 ? `Â¥${selectedProduct.price}` : 'å…è´¹'}</span>
                            </div>
                            <div className="flex gap-3">
                                <Button variant="secondary" onClick={() => setSelectedProduct(null)}>å†çœ‹çœ‹</Button>
                                {!checkCompatibility(selectedProduct.minVersionRequired) ? <Button onClick={() => { setSelectedProduct(null); setShowUpgradeModal(true); }} className="bg-gradient-to-r from-amber-500 to-orange-500 border-none">å»å‡çº§ç‰ˆæœ¬</Button> : <Button onClick={() => initiateAppPurchase(selectedProduct)} className="px-8 shadow-blue-200">ç«‹å³è´­ä¹°</Button>}
                            </div>
                        </div>

                        {/* Decoupled Floating Product Consultant Widget */}
                        <ProductConsultantWidget />
                    </div>
                </Modal>
            )}

            {/* Order Detail Modal */}
            <Modal isOpen={!!showOrderDetailModal} onClose={() => setShowOrderDetailModal(null)} title="è®¢å•è¯¦æƒ…" maxWidth="max-w-2xl">
                {showOrderDetailModal && (
                    <div className="bg-white">
                        <div className="bg-gray-50 px-8 py-6 flex justify-between items-center border-b border-gray-100">
                            <div className="flex items-center gap-4">
                                <div className={`w-12 h-12 rounded-full flex items-center justify-center ${showOrderDetailModal.status === 'success' ? 'bg-green-100 text-green-600' : 'bg-yellow-100 text-yellow-600'}`}>
                                    {showOrderDetailModal.status === 'success' ? <CheckCircle2 size={24} /> : <Clock size={24}/>}
                                </div>
                                <div>
                                    <h2 className="text-xl font-bold text-gray-900">{showOrderDetailModal.status === 'success' ? 'äº¤æ˜“æˆåŠŸ' : 'å¾…ç¡®è®¤'}</h2>
                                    <p className="text-sm text-gray-500 mt-1">{showOrderDetailModal.status === 'success' ? 'æœåŠ¡å·²è‡ªåŠ¨å¼€é€šã€‚' : 'æ­£åœ¨ç­‰å¾…æ±‡æ¬¾ç¡®è®¤ã€‚'}</p>
                                </div>
                            </div>
                            <div className="text-right"><div className="text-xs text-gray-400 mb-1">å®ä»˜é‡‘é¢</div><div className="text-2xl font-bold text-gray-900">Â¥ {Math.abs(showOrderDetailModal.amount).toFixed(2)}</div></div>
                        </div>
                        <div className="p-8 space-y-8">
                            <section>
                                <div className="bg-white border border-gray-200 rounded-lg p-4 flex gap-4 items-start">
                                    <div className="w-16 h-16 bg-blue-50 rounded-lg flex items-center justify-center text-blue-600 flex-shrink-0"><Zap size={24}/></div>
                                    <div className="flex-1">
                                        <h3 className="font-bold text-gray-900">{showOrderDetailModal.item}</h3>
                                        <p className="text-sm text-gray-500 mt-1">æ”¯ä»˜æ–¹å¼ï¼š{showOrderDetailModal.paymentMethod}</p>
                                    </div>
                                </div>
                            </section>
                        </div>
                        <div className="p-6 border-t border-gray-100 bg-gray-50 flex justify-between items-center">
                            <div className="text-sm text-gray-500">é‡åˆ°é—®é¢˜ï¼Ÿè”ç³»å®¢æœ 400-888-9999</div>
                            <div className="flex gap-3">
                                {!showOrderDetailModal.invoiced && showOrderDetailModal.status === 'success' && showOrderDetailModal.type !== 'withdrawal' && <Button variant="outline" onClick={() => setShowInvoiceApplyModal(showOrderDetailModal.id)}><Receipt size={16}/> ç´¢å–å‘ç¥¨</Button>}
                                <Button onClick={() => setShowOrderDetailModal(null)}>å…³é—­</Button>
                            </div>
                        </div>
                    </div>
                )}
            </Modal>

            {/* Auth Overview Modal */}
            <Modal isOpen={showAuthModal} onClose={() => setShowAuthModal(false)} title="å„é—¨åº—åº”ç”¨ä½¿ç”¨æƒ…å†µ" maxWidth="max-w-3xl">
                <div className="p-6">
                    <div className="text-sm text-gray-500 mb-4 bg-gray-50 p-3 rounded-lg border border-gray-100 flex items-start gap-2">
                        <Info size={16} className="mt-0.5 text-blue-500"/>
                        <div>æ­¤å¤„å±•ç¤ºæ‰€æœ‰å·²è´­åº”ç”¨åœ¨å„é—¨åº—çš„åˆ†é…æƒ…å†µã€‚<br/>å…¨è¿é”åº”ç”¨é»˜è®¤å¯¹æ‰€æœ‰é—¨åº—å¼€å¯ï¼›å•åº—æˆæƒåº”ç”¨éœ€æ‰‹åŠ¨åˆ†é…é¢åº¦ã€‚</div>
                    </div>
                    <table className="w-full text-left text-sm">
                        <thead className="bg-gray-50 text-gray-500"><tr><th className="p-3 rounded-l-lg">åº”ç”¨åç§°</th><th className="p-3">ç±»å‹</th><th className="p-3">ä¸­å¿ƒåŒ»é™¢</th><th className="p-3">åŸè¥¿åˆ†é™¢</th><th className="p-3 rounded-r-lg">é«˜æ–°åŒºåˆ†é™¢</th></tr></thead>
                        <tbody className="divide-y divide-gray-100">
                            {PRODUCTS.filter(p => p.isOwned).map(p => (
                                <tr key={p.id}>
                                    <td className="p-3 font-medium text-gray-900">{p.title}</td>
                                    <td className="p-3">{p.scope === 'all_stores' ? <span className="text-blue-600 text-xs bg-blue-50 px-2 py-0.5 rounded">å…¨è¿é”</span> : <span className="text-gray-500 text-xs bg-gray-100 px-2 py-0.5 rounded">å•åº—</span>}</td>
                                    <td className="p-3">{p.scope === 'all_stores' || p.purchaseInfo?.authorizedStores?.includes('ä¸­å¿ƒåŒ»é™¢ - é—¨è¯Šéƒ¨') ? <CheckCircle2 size={16} className="text-green-500"/> : <span className="text-gray-300">-</span>}</td>
                                    <td className="p-3">{p.scope === 'all_stores' || p.purchaseInfo?.authorizedStores?.includes('åŸè¥¿åˆ†é™¢') ? <CheckCircle2 size={16} className="text-green-500"/> : <span className="text-gray-300">-</span>}</td>
                                    <td className="p-3">{p.scope === 'all_stores' ? <CheckCircle2 size={16} className="text-green-500"/> : <span className="text-gray-300">-</span>}</td>
                                </tr>
                            ))}
                        </tbody>
                    </table>
                    <div className="mt-6 flex justify-end"><Button onClick={() => setShowAuthModal(false)}>å…³é—­</Button></div>
                </div>
            </Modal>

            {/* Guide Modal */}
            <Modal isOpen={!!viewingGuide} onClose={() => setViewingGuide(null)} title={`${viewingGuide?.title} - å¿«é€Ÿä¸Šæ‰‹`} maxWidth="max-w-2xl">
                    <div className="p-8">
                    <div className="flex items-center gap-4 mb-8">
                        <div className={`w-16 h-16 rounded-xl ${viewingGuide?.imageColor} flex items-center justify-center`}><BookOpen size={32} className="text-gray-700"/></div>
                        <div><h3 className="font-bold text-xl text-gray-900">3 æ­¥å¯ç”¨æŒ‡å—</h3><p className="text-gray-500 text-sm">è·ŸéšæŒ‡å¼•ï¼Œå¿«é€Ÿå®Œæˆé…ç½®</p></div>
                    </div>
                    <div className="space-y-8 relative before:absolute before:left-4 before:top-4 before:bottom-4 before:w-0.5 before:bg-gray-100">
                        {(viewingGuide?.guideSteps || [{ title: "è¿›å…¥é…ç½®åå°", desc: "ç‚¹å‡»ä¸‹æ–¹çš„â€œå‰å¾€è®¾ç½®â€æŒ‰é’®ï¼Œè¿›å…¥åº”ç”¨ç®¡ç†ç•Œé¢ã€‚" }, { title: "å¼€å¯åŠŸèƒ½å¼€å…³", desc: "åœ¨è®¾ç½®é¡µä¸­æ‰¾åˆ°ã€å¯ç”¨çŠ¶æ€ã€‘ï¼Œåˆ‡æ¢ä¸ºå¼€å¯ã€‚" }, { title: "åˆ†é…æƒé™", desc: "åœ¨ã€æƒé™ç®¡ç†ã€‘ä¸­å‹¾é€‰å¯ä»¥ä½¿ç”¨è¯¥åŠŸèƒ½çš„åŒ»ç”Ÿæˆ–æŠ¤å£«ã€‚" }]).map((step: any, i: number) => (
                            <div key={i} className="relative pl-12">
                                <div className="absolute left-0 top-0 w-8 h-8 rounded-full bg-white border-2 border-blue-500 text-blue-600 font-bold flex items-center justify-center text-sm z-10">{i + 1}</div>
                                <h4 className="font-bold text-gray-900 mb-1">{step.title}</h4>
                                <p className="text-gray-600 text-sm leading-relaxed">{step.desc}</p>
                            </div>
                        ))}
                    </div>
                    <div className="mt-10 pt-6 border-t border-gray-100 flex justify-end gap-3"><Button variant="secondary" onClick={() => setViewingGuide(null)}>ç¨åå†çœ‹</Button><Button onClick={() => { setViewingGuide(null); alert(`æ­£åœ¨å‰å¾€ ${viewingGuide?.title} è®¾ç½®é¡µé¢...`); }}>ç«‹å³å‰å¾€è®¾ç½®</Button></div>
                    </div>
            </Modal>

            {/* Device Status Modal */}
            <Modal isOpen={!!viewingDevice} onClose={() => setViewingDevice(null)} title="è®¾å¤‡çŠ¶æ€ç›‘æ§" maxWidth="max-w-md">
                <div className="p-6">
                    <div className="bg-green-50 border border-green-100 p-4 rounded-xl flex items-center gap-4 mb-6"><div className="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center text-green-600"><Wifi size={24}/></div><div><div className="font-bold text-green-800 text-lg">è®¾å¤‡åœ¨çº¿</div><div className="text-green-600 text-xs">ç½‘ç»œè¿æ¥æ­£å¸¸ï¼Œä¿¡å·å¼º</div></div></div>
                    <div className="space-y-4">
                        <div className="flex justify-between items-center py-2 border-b border-gray-50"><span className="text-gray-500 text-sm">è®¾å¤‡åç§°</span><span className="font-medium text-gray-900">{viewingDevice?.title}</span></div>
                        <div className="flex justify-between items-center py-2 border-b border-gray-50"><span className="text-gray-500 text-sm">åºåˆ—å· (SN)</span><span className="font-mono text-gray-900">ABC-20231024-001</span></div>
                        <div className="flex justify-between items-center py-2 border-b border-gray-50"><span className="text-gray-500 text-sm">å›ºä»¶ç‰ˆæœ¬</span><span className="font-mono text-gray-900">v2.1.0 (æœ€æ–°)</span></div>
                        <div className="flex justify-between items-center py-2 border-b border-gray-50"><span className="text-gray-500 text-sm">æœ€åå¿ƒè·³</span><span className="text-gray-900">åˆšåˆš</span></div>
                    </div>
                    <div className="mt-8 grid grid-cols-2 gap-3"><Button variant="secondary" className="w-full text-red-600 hover:bg-red-50 border-red-100"><Power size={16}/> é‡å¯è®¾å¤‡</Button><Button variant="secondary" className="w-full"><RefreshCw size={16}/> åˆ·æ–°çŠ¶æ€</Button></div>
                </div>
            </Modal>

            {/* Withdraw Modal */}
            <Modal isOpen={showWithdrawModal} onClose={() => setShowWithdrawModal(false)} title="ä½™é¢æç°" maxWidth="max-w-md">
                <div className="p-6">
                    <div className="bg-orange-50 p-4 rounded-lg mb-6 flex gap-3 text-orange-800 text-sm"><AlertCircle size={18} className="flex-shrink-0 mt-0.5"/><div>æç°é‡‘é¢å°†åŸè·¯é€€å›è‡³æ‚¨çš„æ”¯ä»˜è´¦æˆ·ï¼ˆå¾®ä¿¡/æ”¯ä»˜å®ï¼‰ï¼Œæˆ–æ‰“æ¬¾è‡³å¯¹å…¬è´¦æˆ·ã€‚é¢„è®¡ 3 ä¸ªå·¥ä½œæ—¥åˆ°è´¦ã€‚</div></div>
                    <div className="mb-6"><div className="flex justify-between text-sm mb-2"><span className="text-gray-700 font-medium">æç°é‡‘é¢</span><span className="text-gray-500">å¯æç°: Â¥{balance.toFixed(2)}</span></div><div className="relative"><span className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 font-bold">Â¥</span><input type="number" placeholder="0.00" value={withdrawAmount || ''} onChange={(e) => setWithdrawAmount(Math.min(Number(e.target.value), balance))} className="w-full border border-gray-300 rounded-lg pl-8 pr-20 py-3 text-lg font-bold focus:ring-2 focus:ring-blue-500 outline-none"/><button onClick={() => setWithdrawAmount(balance)} className="absolute right-2 top-1/2 -translate-y-1/2 text-blue-600 text-xs font-bold px-2 py-1 hover:bg-blue-50 rounded">å…¨éƒ¨æç°</button></div></div>
                    <div className="mt-6 flex gap-3"><Button variant="secondary" className="flex-1" onClick={() => setShowWithdrawModal(false)}>å–æ¶ˆ</Button><Button className="flex-1" onClick={handleWithdraw} disabled={!withdrawAmount || withdrawAmount <= 0}>ç¡®è®¤æç°</Button></div>
                </div>
            </Modal>

            {/* Invoice Config */}
            <Modal isOpen={showInvoiceConfigModal} onClose={() => setShowInvoiceConfigModal(false)} title="å‘ç¥¨æŠ¬å¤´é…ç½®" maxWidth="max-w-lg">
                <div className="p-6 space-y-4">
                    <div><label className="block text-sm font-medium text-gray-700 mb-1">æŠ¬å¤´åç§°</label><input type="text" value={invoiceInfo.title} onChange={e => setInvoiceInfo({...invoiceInfo, title: e.target.value})} className="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 outline-none" /></div>
                    {invoiceInfo.type === 'company' && (<div><label className="block text-sm font-medium text-gray-700 mb-1">ç¨å·</label><input type="text" value={invoiceInfo.taxId} onChange={e => setInvoiceInfo({...invoiceInfo, taxId: e.target.value})} className="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 outline-none" /></div>)}
                    <div className="pt-4 flex gap-3"><Button variant="secondary" className="flex-1" onClick={() => setShowInvoiceConfigModal(false)}>å–æ¶ˆ</Button><Button className="flex-1" onClick={() => setShowInvoiceConfigModal(false)}>ä¿å­˜</Button></div>
                </div>
            </Modal>

            {/* Recharge Modal */}
            <Modal isOpen={showRechargeModal} onClose={() => setShowRechargeModal(false)} title="ä½™é¢å……å€¼" maxWidth="max-w-md">
                <div className="p-6">
                    <div className="grid grid-cols-2 gap-3 mb-4">{[500, 1000, 2000, 5000].map(amt => (<button key={amt} onClick={() => setRechargeAmount(amt)} className={`p-4 border rounded-xl text-center transition-all ${rechargeAmount === amt ? 'border-blue-600 bg-blue-50 text-blue-700 ring-1 ring-blue-600' : 'border-gray-200 hover:border-blue-300'}`}><div className="font-bold text-lg">Â¥{amt}</div></button>))}</div>
                    <div className="flex gap-3"><Button variant="secondary" className="flex-1" onClick={() => setShowRechargeModal(false)}>å–æ¶ˆ</Button><Button className="flex-1" onClick={handleRecharge} disabled={!rechargeAmount}>ç¡®è®¤å……å€¼</Button></div>
                </div>
            </Modal>

            {/* Invoice Apply */}
            <Modal isOpen={showInvoiceApplyModal} onClose={() => setShowInvoiceApplyModal(null)} title="ç”³è¯·å¼€ç¥¨" maxWidth="max-w-md" zIndex={60}>
                    <div className="p-6">
                    <div className="bg-blue-50 p-4 rounded-lg mb-4 text-sm text-blue-800 border border-blue-100">
                        <div className="font-bold mb-2">ç¡®è®¤å‘ç¥¨ä¿¡æ¯</div>
                        <div className="grid grid-cols-[80px_1fr] gap-1"><span className="text-blue-500">æŠ¬å¤´ï¼š</span><span>{invoiceInfo.title}</span><span className="text-blue-500">ç¨å·ï¼š</span><span>{invoiceInfo.taxId || '-'}</span><span className="text-blue-500">é‡‘é¢ï¼š</span><span className="font-bold">Â¥{transactions.find(t => t.id === showInvoiceApplyModal)?.amount.toFixed(2)}</span></div>
                    </div>
                    <div className="flex gap-3"><Button variant="secondary" className="flex-1" onClick={() => setShowInvoiceApplyModal(null)}>å–æ¶ˆ</Button><Button className="flex-1" onClick={() => handleApplyInvoice(showInvoiceApplyModal || '')}>ç¡®è®¤ç”³è¯·</Button></div>
                    </div>
            </Modal>

        </div>
    );
}